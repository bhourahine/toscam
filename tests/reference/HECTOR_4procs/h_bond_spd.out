 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                              Version 3.0      |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Peter D. Haynes, Nicholas D. M. Hine, Arash. A. Mostofi,     |
 |  Mike C. Payne and Chris-Kriton Skylaris                      |
 |                                                               |
 |  Contributors:                                                |
 |  P. W. Avraam, S. J. Clark, O. Dieguez, S. M. M. Dubois,      |
 |  J. Dziedzic, H. H. Helal, Q. O. Hill, D. D. O`Regan,         |
 |  C. J. Pickard, M. I. J. Probert, L. Ratcliff, M. Robinson    |
 |  and A. Ruiz Serrano                                          |
 |                                                               |
 |                                   Copyright (c) 2004-2011     |
 |                                                               |
 |  Please cite:                                                 |
 |  "Introducing ONETEP: Linear-scaling density functional       |
 |   simulations on parallel computers".                         |
 |   C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, M. C. Payne.   |
 |   J. Chem. Phys. 122 084119 (2005).                           |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 28-05-2011 00:02 (+0100)

Running on     4 processors.

Reading parameters from file "h_bond_spd.dat" ...... done
Reading geometry and species blocks from file "h_bond_spd.dat" ...    
  PSINC grid spacing along a1 set to   0.600000000000a0 from input file.
  Number of PPD points along a1 set to 5 from input file.
  PSINC grid spacing along a2 set to   0.600000000000a0 from input file.
  Number of PPD points along a2 set to 5 from input file.
  PSINC grid spacing along a3 set to   0.600000000000a0 from input file.
  Number of PPD points along a3 set to 5 from input file.
... done
-------------------------------------------------------------------------------
---------------------------- RUN-TIME PARAMETERS ------------------------------
-------------------------------------------------------------------------------
task                       : SINGLEPOINT *! Type of calculation (String)        
cutoffenergy               : 20.00000000000000       hartree *! Plane wave kine 
kernelcutoff               : 1000.000000000000 *! Density kernel radius in Bohr 
xcfunctional               : LDA *! Exchange-correlation functional (String)    
libxcxfuncid               : 0 *! Functional identifier for which exchange func 
libxccfuncid               : 0 *! Functional identifier for which correlation f 
charge                     : 0.000000000000000 *! The total charge of the syste 
spin                       : 0 *! Total spin of system (Integer)                
spinpolarized              : F *! Switch for spin polarization (Boolean)        
spinpolarised              : F *! Switch for spin polarisation (Boolean)        
constantefield             : 0.0 0.0 0.0 *! Cartesian coordinates of constant e 
fftboxpref                 : 65 65 65 *! Preferred FFT box dimensions (String)  
ppdnpoints                 : 5  5  5 *! PPD edge length in grid points for each 
psincspacing               : 0.6  0.6  0.6 *! PSINC grid spacing in atomic unit 
oldinput                   : F *! Read old-format input file (Boolean)          
develcode                  : *! For development code only (String)              
nnho                       : F *! Initialise NGWFs to nonorthogonal natural hyb 
ngwfhalo                   : -1.000000000000000 *! Halo extension to NGWF radii 
nonscforces                : F *! Include non self-consistent forces due to NGW 
maxitpalsermano            : 50 *! Maximum number of iterations for Palser-Mano 
maxitpen                   : 3 *! Max number of penalty functional iterations ( 
penparam                   : 4.000000000000000 *! Penalty functional parameter  
minitlnv                   : 3 *! Min number of LNV iterations (Integer)        
maxitlnv                   : 8 *! Max number of LNV iterations (Integer)        
maxitlnvcoarse             : 0 *! Max number of low-accuracy LNV iterations (In 
lnvthresholdorig           : 1.0000000000000001E-009 *! LNV convergence thresho 
lnvcgtype                  : LNV_FLETCHER *! Type of CG coefficient for LNV den 
lnvcgmaxstep               : 3.000000000000000 *! Maximum length of trial step  
exactlnv                   : F *! Use original LNV algorithm (Boolean)          
oldlnv                     : T *! Use LNV algorithm backwards compatible pre De 
lnvchecktrialsteps         : F *! Check stability of kernel at each trial step  
kerfix                     : 1 *! Density kernel fixing approach (Integer)      
maxitkernelfix             : 3 *! Maximum # iterations of Penalty Functional id 
initialdensrealspace       : F *! Construct initial density in real space from  
kerneldiis                 : F *! Use kernel DIIS in the inner loop (Boolean)   
kerneldiistype             : P *! Density mixing method (String)                
kerneldiismax              : 10 *! Max number of kernels saved during kernel DI 
kerneldiismaxit            : 25 *! Max number of kernel DIIS iterations (Intege 
kerneldiisthres            : 1.0000000000000001E-009 *! Density mixing converge 
kerneldiisliter            : 5 *! Number of linear mixing iterations (Integer)  
kerneldiiscin              : 0.9000000000000000 *! Coefficient for the input ke 
kerneldiiscriteria         : 1000 *! Density mixing convergence criteria (Strin 
maxitngwfcg                : 60 *! Max number of NGWF conjugate gradients (CG)  
ngwfcgtype                 : NGWF_FLETCHER *! Type of CG coefficient for NGWF o 
ngwfcgmaxstep              : -8.000000000000000 *! Maximum length of trial step 
eleccgmax                  : 5 *! Number of NGWF iterations to reset CG (Intege 
precondscheme              : TETER *! Recip-space preconditioning scheme (Strin 
kzero                      : 3.000000000000000 *! KE preconditioning parameter  
rprecond                   : 2.000000000000000 *! Radial cut-off for real-space 
precondrecip               : T *! Recip-space KE preconditioning (Boolean)      
precondreal                : F *! Real-space KE preconditioning (Boolean)       
smoothscheme               : NONE *! Smoothing scheme for the NGWF gradients at 
rsmooth                    : 1.500000000000000       bohr *! Radius of the unsh 
ksmooth                    : 5.000000000000000 *! Characteristic wavelength of  
occmix                     : 0.2500000000000000 *! Mix fraction of occupancy pr 
kernelupdate               : F *! Update density kernel during NGWF line search 
kernelchristoffelupdate    : F *! Update density kernel during NGWF line search 
maxithotelling             : 50 *! Number of Hotelling iteration per NGWF chang 
maxresidhotelling          : 9.9999999999999998E-013 *! Max allowed value in Ho 
maxitngwfdiis              : 0 *! Max number of NGWF DIIS steps (Integer)       
ngwfdiissize               : 4 *! Max size of the DIIS iterative subspace (Inte 
ngwfdiisreset              : 8 *! Max number of iteration for the resetting of  
ngwfdiismaxstep            : 2.000000000000000 *! Max length of trial step for  
ngwfthresholdorig          : 1.9999999999999999E-006 *! NGWF convergence thresh 
elecenergytol              : -1.0000000000000000E-003  hartree *! Tolerance on  
elecforcetol               : -1.0000000000000000E-003  ha/bohr *! Tolerance on  
ngwfmaxgrad                : -2.0000000000000002E-005 *! Maximum permissible va 
deltaeconv                 : T *! Use consecutive energy gains as a criterion f 
locpotintbatchsize         : 10 *! Size of NGWF in fftbox batch for locpot inte 
kineticintbatchsize        : 10 *! Size of NGWF in fftbox batch for kinetic int 
densitybatchsize           : 10 *! Size of NGWF in fftbox batch for charge dens 
ngwfgradbatchsize          : 10 *! Size of NGWF in fftbox batch for NGWF gradie 
densethreshold             : 0.4000000000000000 *! Threshold for matrix segment 
commsgroupsize             : 4 *! Number of nodes in a group (determines comms  
ovlpfornonlocal            : F *! Overlap sparsity for nonlocal (Boolean)       
usespacefillingcurve       : T *! Re-arrange atoms according to space-filling c 
corehamdenskernguess       : T *! Initial guess for density kernel from core Ha 
checkatoms                 : T *! Check atoms on top of each other (Boolean)    
locpotscheme               : FULL *! Scheme for evaluating local potential matr 
smoothprojectors           : -0.4000000000000000 *! Halfwidth of Gaussian filte 
smoothlocpspot             : -0.4000000000000000 *! Halfwidth of Gaussian filte 
oddpsincgrid               : F *! Force odd number of points in simcell psinc g 
evenpsincgrid              : F *! Force even number of points in simcell psinc  
realspaceprojectors        : F *! Whether to evaluate and store projectors in r 
outputdetail               : VERBOSE *! Level of output detail (String)         
pawoutputdetail            : DEFAULT *! Level of output detail for PAW: BRIEF,  
timingslevel               : 0 *! Level of timings output: 0(none) 1(nodes summ 
writeparams                : T *! Output runtime parameters at startup (Boolean 
writeforces                : F *! Write ionic forces (Boolean)                  
writepositions             : T *! Write ionic positions each geometry or MD ste 
writexyz                   : F *! Output coordinates in .xyz file (Boolean)     
printqc                    : T *! Print Quality Control information (Boolean)   
cubeformat                 : F *! Allow .cube format for plot outputs (Boolean) 
dxformat                   : F *! Allow .dx format for plot outputs (Boolean)   
dxformatcoarse             : F *! Output only points on the coarse grid (Boolea 
dxformatdigits             : 7 *! Number of significant digits in .dx output (I 
grdformat                  : T *! Allow .grd format for plot outputs (Boolean)  
writedensityplot           : T *! Write the charge density in plotting format ( 
writengwfplot              : F *! Write NGWFs in plotting format (Boolean)      
writengwfgradplot          : F *! Write NGWF Gradients in plotting format (Bool 
writengwfradial            : F *! Write NGWFs radial distributions (Boolean)    
writengwfgradradial        : F *! Write NGWFs gradients radial distributions (B 
writeradialstep            : 5.0000000000000001E-003  bohr *! Define the grid s 
writeradialsmear           : 1.0000000000000000E-002  bohr *! Define the gaussi 
readdenskern               : F *! Read density kernel restart information (Bool 
writedenskern              : F *! Write density kernel restart information (Boo 
readtightboxngwfs          : F *! Read in universal tightbox NGWFs restart info 
writetightboxngwfs         : F *! Write in universal tightbox NGWFs restart inf 
writeconvergeddkngwfs      : F *! Only write Density Kernel and NGWFs upon conv 
readswngwfs                : F *! Read NGWFs restart information in spherical w 
writeswngwfs               : F *! Write NGWFs restart information in spherical  
writemaxl                  : 3 *! Maximum angular momentum number when writing  
readmaxl                   : 3 *! Maximum angular momentum number when reading  
extransw                   : 0 *! Maximum number of zeros of the sph Bessel fun 
paw                        : F *! Uses a PAW construction to find correct core  
finegridscale              : 2.000000000000000 *! Ratio of size of fine grid to 
dblgridscale               : 2.000000000000000 *! Ratio of charge density / pot 
augfuncsrecip              : T *! Construct Augmentation functions in recip spa 
dispersion                 : 0 *! Select dispersion correction (Integer)        
vdwdcoeff                  : -1.000000000000000 *! Replacement VDW damping coef 
hubbardmaxiter             : 0 *! Maximum number of DFT+U projector optimisatio 
hubbardenergytol           : 1.0000000000000000E-008  hartree *! Energy toleran 
hubbardconvwin             : 2 *! Energy convergence window when using DFT+U pr 
hubbardprojmixing          : 0.000000000000000 *! Proportion of old Hubbard pro 
hubbardfunctional          : 1 *! DFT+U energy functional to use (Integer)      
hubbardtensorcorr          : 1 *! DFT+U projector tensorial correction to use ( 
hubbardngwfspinthreshold   : 2.0000000000000002E-005 *! NGWF RMS  gradient thre 
coulombcutoffradius        : 0.000000000000000 *! Radius of sphere or cylinder  
coulombcutofflength        : 0.000000000000000 *! Length of cylinder or width o 
coulombcutofftype          : NONE *! Type of cutoff coulomb interaction: NONE,  
coulombcutoffwriteint      : F *! Write real-space cutoff Coulomb interaction s 
pbccorrectioncutoff        : 0.000000000000000 *! alpha*L cutoff parameter for  
doproperties               : F *! Allow calculation of properties (Boolean)     
numeigenvalues             : 10 *! Number of energy and occupancy eigenvalues t 
homodensplot               : -1 *! Number of squared MOs to plot from HOMO and  
lumodensplot               : -1 *! Number of squared MOs to plot from LUMO and  
homoplot                   : 5 *! Number of MOs to plot from HOMO and lower (In 
lumoplot                   : 5 *! Number of MOs to plot from LUMO and higher (I 
dossmear                   : 3.6749324387552883E-003  hartree *! Half width of  
ldossmear                  : 3.6749324387552883E-003  hartree *! Lorentzian bro 
popncalculate              : F *! Allow population analysis (Boolean)           
popnbondcutoff             : 5.669178403750646       bohr *! Bond length cutoff 
ngwfanalysis               : F *! Perform NGWF analysis (Boolean)               
polarisationcalculate      : F *! Allow calculation of polarisation (Boolean)   
spreadcalculate            : F *! Calculate spread of NGWFs (Boolean)           
geommodulusest             : 1.7000000000000001E-002  ha/bohr**3 *! The estimat 
geomfrequencyest           : 7.6000000000000000E-003  hartree *! The estimated  
geomenergytol              : 9.9999999999999995E-007  hartree *! Geometry optim 
geomforcetol               : 2.0000000000000000E-003  ha/bohr *! Geometry optim 
geomdisptol                : 5.0000000000000001E-003  bohr *! Geometry optimiza 
geommaxiter                : 50 *! Maximum number of geometry optimization iter 
geomconvergencewin         : 2 *! Geometry optimization convergence tolerance w 
geomcontinuation           : F *! Read information for continuation of a previo 
geombackupiter             : 1 *! Number of geometry optimisation iterations be 
geomresetdkngwfsiter       : 6 *! Number of geom iterations between resets of k 
geomreusedkngwfs           : T *! Re-use density kernel and NGWFs during geomet 
geomprintinvhessian        : F *! Write inverse Hessian to standard output (Boo 
geommethod                 : CARTESIAN *! Method for geometry optimization (Str 
tssearchmethod             : LSTQST *! Specifies method to be used for TS searc 
tssearchlstqstprotocol     : LSTMAXIMUM *! Specifies LSTQST protocol (String)   
tssearchqstmaxiter         : 5 *! Specifies maximum number of QST steps (Intege 
tssearchcgmaxiter          : 20 *! Specifies maximum number of CG steps (Intege 
tssearchforcetol           : 5.0000000000000001E-003  ha/bohr *! Force toleranc 
tssearchdisptol            : 1.0000000000000000E-002  bohr *! Displacement tole 
mddeltat                   : 40.00000000000000       aut *! Molecular dynamics  
mdnumiter                  : 100 *! Maximum number of molecular dynamics iterat 
mdtemperature              : 9.5000000000000000E-004  hartree *! Temperature fo 
mdalgorithm                : LEAPFROGVERLET *! Integration algorithm for molecu 
mdthermostat               : NONE *! Thermostat for molecular dynamics (String) 
mdcollisionfrequency       : 0.1520000000000000       hartree *! Collision freq 
mixdenskern                : 0 *! Number of coefficients used to build new gues 
mixngwfs                   : 0 *! Number of coefficients used to build new gues 
condreaddenskern           : F *! Read in conduction density kernel (Boolean)   
condreadtightboxngwfs      : F *! Read in universal tightbox conduction NGWFs ( 
condfixedshift             : F *! Fixed projected conduction Hamiltonian shift  
condcalcmaxeigen           : T *! Calculate maximum conduction Hamiltonian eige 
condnumstates              : 0 *! Number of conduction states to be optimised f 
condkernelcutoff           : 1000.000000000000 *! Conduction density kernel rad 
condinitshift              : 0.000000000000000 *! Initial shifting factor for p 
condshiftbuffer            : 0.1000000000000000 *! Additional buffer for updati 
condnumextrastates         : 0 *! Number of extra conduction states for initial 
condnumextraits            : 0 *! Number of NGWF iterations with extra conducti 
condplotjointorbitals      : T *! Plot orbitals in the joint basis following a  
condplotvcorbitals         : T *! Plot orbitals in the val and cond NGWF basis  
condcalcopticalspectra     : F *! Calculate matrix elements for optical absorpt 
condspeccalcmommatels      : T *! Calculate momentum matrix elements (default t 
condspeccalcnonloccomm     : T *! Calculate nonlocal commutator for momentum ma 
condspeccontderiv          : T *! Calculate non-local commuator using continuou 
condspecnonloccommshift    : 1.0000000000000000E-004 *! Finite difference shift 
bskpointpathspacing        : 0.1889727000000000       1/bohr *! K-point spacing 
bsnumeigenvalues           : -1 *! Num of energy and occ. eigenvalues to print  
bsunfold                   : 0 0 0 *! Number of times to unfold Brillouin zone  
bsmethod                   : TB *! Method to use: 'KP' or 'TB' (String)         
dotddft                    : F *! Allow Time-Dependent DFT calculation (Boolean 
tddftmaximumenergy         : 1.000000000000000       hartree *! Desired maximum 
tddftresolution            : 1.0000000000000000E-003  hartree *! Desired resolu 
tddftpropagationmethod     : CRANKNICHOLSON *! Method used to integrate von Neu 
tddftsparsitylevel         : 0 *! Matrix sparsity when computing propagators e. 
tddfttammdancoff           : F *! Invoke Tamm-Dancoff decoupling approximation  
tddftdipolekickstrength    : 0.0 0.0 0.0 *! Maximum allowed phase shift in TDDF 
tddftxcfunctional          : LDA *! Exchange-correlation functional for TDDFT ( 
tddfthamiltonianmixing     : 0 *! Order of polynomial extrapolation to H(t + ha 
tddftdamping               : 0.000000000000000       hartree *! Energy smearing 
tddftenforcedidempotency   : F *! Project out at each timestep that part of cha 
tddftmaxithotelling        : 50 *! Number of Hotelling iteration per propagatio 
tddftmaxresidhotelling     : 1.0000000000000001E-018 *! Max allowed value in Ho 
tddftinvoverlapexact       : T *! Renew inverse overlap with O N^3 algorithm be 
isimplicitsolvent          : F *! Use implicit solvent? (Boolean)               
issmearedionrep            : F *! Implicit solvent: use smeared ions for electr 
isincludecavitation        : F *! Implicit solvent: include cavitation energy ( 
isdensitythreshold         : 7.7999999999999999E-004 *! Implicit solvent: rho_0 
issolvationbeta            : 1.300000000000000 *! Implicit solvent: beta parame 
isbulkpermittivity         : 1.000000000000000 *! Implicit solvent: eps_inf par 
ismultigriddefecterrortol  : 1.0000000000000000E-002 *! Implicit solvent: stop  
ismultigriderrortol        : 1.0000000000000001E-005 *! Implicit solvent: stop  
issmearedionwidth          : 0.8000000000000000 *! Implicit solvent: Width of G 
issurfacethickness         : 2.0000000000000001E-004 *! Implicit solvent: thick 
issolventsurfacetension    : 4.7623999999999997E-005  ha/bohr**2 *! Implicit so 
ismultigridmaxiters        : 100 *! Implicit solvent: max number of iterations  
ismultigridnlevels         : 4 *! Implicit solvent: number of levels in multigr 
isdiscretizationorder      : 8 *! Implicit solvent: discretization order (2nd,  
isbccoarseness             : 5 *! Implicit solvent: controls boundary condition 
isbcsurfacecoarseness      : 1 *! Implicit solvent: controls boundary condition 
ischecksolvenergygrad      : F *! Implicit solvent: sanity check the energy gra 
issolvationmethod          : DIRECT *! Implicit solvent: direct or corrective m 
isdielectricmodel          : FIX_INITIAL *! Implicit solvent: how the cavity is 
isdielectricfunction       : FGF *! Implicit solvent: how the cavity is determi 
issolvationoutputdetail    : NONE *! Implicit solvent: controls extra output (S 
openbcionion               : F *! Force open BCs in ion-ion energy (Boolean)    
openbchartree              : F *! Force open BCs in Hartree potential (Boolean) 
openbcpspot                : F *! Force open BCs in local pseudopotential (Bool 
openbcpspotfinetunenptsx   : 100000 *! Open BCs in local pseudo, npts_x paramet 
openbcpspotfinetunealpha   : 0.3000000000000000 *! Open BCs in local pseudo, al 
openbcpspotfinetunef       : -1 *! Open BCs in local pseudo, fineness parameter 
%block positionsabs        : *! Cartesian positions for each atom (Block)       
O     24.887507   23.896975   22.647313                                         
C     27.731659   23.667449   22.643306                                         
H     28.655157   21.721170   22.637547                                         
H     28.955467   25.440371   22.646039                                         
O     19.766101   21.820471   22.648599                                         
H     17.687651   22.103070   22.651801                                         
H     20.725313   23.685785   22.651874                                         
%endblock positionsabs     : *! Cartesian positions for each atom (Block)       
%block latticecart         : *! The simulation cell lattice vectors (Block)     
51.00     0.00     0.00                                                         
0.00    51.00     0.00                                                          
0.00     0.00    51.00                                                          
%endblock latticecart      : *! The simulation cell lattice vectors (Block)     
%block species             : *! Species information (symbol, atomic number, num 
O    O    8    4    6.3                                                         
C    C    6    4    6.3                                                         
H    H    1    1    6.0                                                         
%endblock species          : *! Species information (symbol, atomic number, num 
%block speciespot          : *! Pseudopotential name for each species (Block)   
O    "../../pseudo/oxygen_spd.recpot"                                           
C    "../../pseudo/carbon_spd.recpot"                                           
H    "../../pseudo/hydrogen_coul.recpot"                                        
%endblock speciespot       : *! Pseudopotential name for each species (Block)   
%block speciesatomicset    : *! Atomic set name for each species (Block)        
O    "../../fireballs/O_SZ_6.0_recpot01_600eV.fbl"                              
C    "../../fireballs/C_SZ_6.0_recpot00_600eV.fbl"                              
H    "../../fireballs/H_SZ_6.0_recpot00_600eV.fbl"                              
%endblock speciesatomicset : *! Atomic set name for each species (Block)        
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>
File: ../../pseudo/oxygen_spd.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 0; rc = 1.01 bohr
    Shell 2: l = 1; rc = 1.60 bohr
    Shell 3: l = 2; rc = 1.60 bohr
File: ../../pseudo/carbon_spd.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  6;  ionic charge:  4.000000
    Shell 1: l = 0; rc = 1.25 bohr
    Shell 2: l = 1; rc = 1.48 bohr
    Shell 3: l = 2; rc = 1.54 bohr
File: ../../pseudo/hydrogen_coul.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  O          2         8        18
  C          1         4         9
  H          4         4         0
.......   ......    ......    ......
Totals:      7        16        27
-------------------------------------------------------------------------------

Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      5;  min      1;  average      4
... Projector load balancing: max      9;  min      0;  average      7
... done

Calculating Ewald energy ...
              Ewald: real-space energy =      27.419782
        Ewald: reciprocal-space energy =       1.617082
         Ewald: (sum_charge)**2 Energy =       2.050031
         Ewald: (sum_charge**2) Energy =       2.494981
                          Ewald Energy =      24.491852
... FFT-box specified

Basis initialisation ...
... Atom positions lie inside simulation cell
... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... NGWF basis size (local,global):       5252     17568
... Tight-boxes gathered
... done

============================== PSINC grid sizes ================================
                      Simulation cell:   85 x  85 x  85
                              FFT-box:   75 x  75 x  75
                                  PPD:    5 x   5 x   5
Grid space d1=  0.600000000000a0 (KE cutoff=  21.10093Eh = 574.18539eV)
Grid space d2=  0.600000000000a0 (KE cutoff=  21.10093Eh = 574.18539eV)
Grid space d3=  0.600000000000a0 (KE cutoff=  21.10093Eh = 574.18539eV)
================================================================================

********************** Fourier parallelisation information *********************
       Coarse grid (whole simulation cell) dimensions:     85    85    85

                 Real-space grid ('12' slabs):
                   Node    0:   21 (from    1 to   21)
                   Node    1:   21 (from   22 to   42)
                   Node    2:   22 (from   43 to   64)
                   Node    3:   21 (from   65 to   85)

                 Reciprocal-space grid ('23' slabs):
                   Node    0:   10 (from    1 to   10)
                   Node    1:   11 (from   11 to   21)
                   Node    2:   11 (from   22 to   32)
                   Node    3:   11 (from   33 to   43)
********************************************************************************

********************** Fourier parallelisation information *********************
       Double grid (whole simulation cell) dimensions:    170   170   170

                 Real-space grid ('12' slabs):
                   Node    0:   42 (from    1 to   42)
                   Node    1:   43 (from   43 to   85)
                   Node    2:   43 (from   86 to  128)
                   Node    3:   42 (from  129 to  170)

                 Reciprocal-space grid ('23' slabs):
                   Node    0:   21 (from    1 to   21)
                   Node    1:   22 (from   22 to   43)
                   Node    2:   22 (from   44 to   65)
                   Node    3:   21 (from   66 to   86)
********************************************************************************

=========================== Sparse matrix information ==========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling:  77.08%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  20.31%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done
NGWF initialisation ...... done

============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.33871996E+01     0.87190191E+00
               2       0.30316759E+01     0.76021902E+00
               3       0.26123384E+01     0.59521760E+00
               4       0.21910196E+01     0.56162116E+00
               5       0.18202926E+01     0.52184614E+00
               6       0.14501423E+01     0.45345952E+00
               7       0.10078164E+01     0.34667257E+00
               8       0.56053713E+00     0.20941740E+00
               9       0.20700313E+00     0.81018545E-01
              10       0.30588735E-01     0.12738583E-01
              11       0.69910598E-03     0.31902406E-03
              12       0.40512447E-06     0.20021199E-06
              13       0.15558576E-12     0.79714013E-13
================================================================================
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1         -11.94807962255007    0.5598212
               2         -12.50452314126496    0.5365235
               3         -13.11828385812498    0.4964768
               4         -13.66822765066119    0.4204953
               5         -13.90271276256000    0.3708508
               6         -13.98655525066407    0.3702002
               7         -14.04461951778295    0.3570595
               8         -14.08019717773767    0.3519629
               9         -14.09914516883591    0.3872966
              10         -14.11438218787470    0.4357469
              11         -14.12764147887177    0.4772619
              12         -14.13739795045895    0.4970262
              13         -14.14246146121419    0.4999495
              14         -14.14362561615946    0.5000000
              15         -14.14367578386360    0.5000000
              16         -14.14367587116507    0.5037016
              17         -14.14367587116533    1.0005105
Final occupancy bounds: [    0.00000000000000:    1.00000000000000]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done
   Initial electron number for spin 1:      20.00000000
     Final electron number for spin 1:      20.00000000
................................................................................
<<<<<<<<<<<<<<<< Penalty functional density kernel optimisation >>>>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |   rms grad  |  commutator |LScoef|CGcoef|      Ne    |
      Q0=E0+P0:     -36.112882380140=    -36.112882380140+      0.000000000000
    Trial step:       1.000000000000
            G0:     -18.294439704764
WARNING: minimum value of charge density: -0.3542
      Q1=E1+P1:     194.964225645113=    -16.927168482761+    211.891394127874
Quadratic term:    -249.371547730017
   Linear term:     -18.294439704764
  Optimal step:       0.036681088663
 Predicted min:     -36.448412362568
    !!! Quadratic minimum step length accepted !!!
 1    -36.11288238014032 0.26732499901 0.22687114576 0.0367  0.000   20.00000000
WARNING: minimum value of charge density: -0.0016
      Q0=E0+P0:     -36.664061604931=    -36.734080059635+      0.070018454704
    Trial step:       0.191523076059
            G0:      -2.669060990142
WARNING: minimum value of charge density: -0.0019
      Q1=E1+P1:     -37.125123307338=    -37.238069744941+      0.112946437603
Quadratic term:      -0.050125068615
   Linear term:      -0.511186771022
  Optimal step:       0.976597793597
 Predicted min:     -37.967361141905
    !!! Quadratic minimum step length accepted !!!
 2    -36.73408005963465 0.18207631623 0.21387178956 0.9766 -0.496   20.00000000
WARNING: minimum value of charge density: -0.0376
      Q0=E0+P0:     -36.541536595289=    -38.970050443334+      2.428513848045
    Trial step:       0.432482385193
WARNING: internal_polak_cg_coeff = 12.64220
WARNING: setting internal_polak_cg_coeff to zero
            G0:    -100.326740848582
WARNING: minimum value of charge density: -1.1727
      Q1=E1+P1:     119.063728769094=      4.677948761945+    114.385780007149
Quadratic term:    -198.994813545256
   Linear term:     -43.389548180873
  Optimal step:       0.047150010986
 Predicted min:     -38.906740061901
    !!! Quadratic minimum step length accepted !!!
 3    -38.97005044333393 0.62602023245 0.25060165113 0.0472  0.000   20.00000000
WARNING: minimum value of charge density: -0.0013

======================== Penalty functional minimisation =======================
   Final total energy     :     -39.025263243563
   Final penalty energy   :       0.537037472650
   RMS occupancy error    :       0.091604
   Occupancy bounds       : [-0.112, 1.169]
================================================================================

Finished density kernel iterations (   3)

################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:      20.00000000
     Final electron number for spin 1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.091604 (step -0.3770 Ne1=     20.0000)
 RMS occupancy error at iteration   2:  0.017373 (step -0.5435 Ne1=     20.0000)
 RMS occupancy error at iteration   3:  0.000879 (step -0.5018 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000002 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<< LNV (Millam-Scuseria variant) density kernel optimisation >>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.000001841670
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -38.211334065226
DltNe tr(Dir*S):       0.000000000000
             G0:      -2.479894043219
   RMS gradient:       0.098422995821
 1    -38.21133406522647 0.00000000000 0.15806726622 0.1000  0.000   20.00000000
      ideal mu1:       0.000000000000
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -38.437870257041
DltNe tr(Dir*S):       0.000000000000
             G0:      -3.164541610250
   RMS gradient:       0.082325113274
 2    -38.43787025704119 0.01432729236 0.13311540042 0.1000  0.700   20.00000000
      ideal mu1:      -0.000000000017
 3    -38.69416911499025 0.02152890372 0.09178736558 0.0000  0.000   20.00000000
Finished density kernel iterations (   3)

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00560011692877              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.36050244E-01     0.13081009E-01
               2       0.43134063E-03     0.21940183E-03
               3       0.10167370E-06     0.59121673E-07
               4       0.78131012E-14     0.48849813E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11509798E+00     0.39981162E-01
               2       0.46421440E-02     0.20813514E-02
               3       0.11196218E-04     0.57789946E-05
               4       0.89176150E-10     0.51874727E-10
               5       0.13887019E-14     0.54817262E-15
================================================================================
RMS gradient                =       0.00560011692877
Trial step length           =               0.122474
Gradient along search dir.  =         -2.35034198785
Functional at step 0        =     -38.69416911499025
Functional at step 1        =     -38.94634941867092
Functional predicted        =     -39.27481267254645
Selected quadratic step     =               0.494093
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               

################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:      20.43785697
     Final electron number for spin 1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.016571 (step -0.4721 Ne1=     20.0000)
 RMS occupancy error at iteration   2:  0.000278 (step -0.5003 Ne1=     20.0000)
 RMS occupancy error at iteration   3:  0.000000 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<< LNV (Millam-Scuseria variant) density kernel optimisation >>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:       0.000000000000
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.281751169515
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.177578625317
   RMS gradient:       0.026337549338
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.500000000000
             Q1:     -39.341497886951
 Quadratic coef:       0.029042595222
 Linear coef   :      -0.088789312659
           Qmin:     -39.349613063244
Quadratic minimum step length (  0.764302501028) accepted
 1    -39.28175116951498 0.00000000000 0.04632440052 0.7643  0.000   20.00000000
      ideal mu1:      -0.000000000124
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.347769188027
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.047658959610
   RMS gradient:       0.014104738711
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.618183832297
             Q1:     -39.364983433806
 Quadratic coef:       0.012247752515
 Linear coef   :      -0.029461998295
           Qmin:     -39.365486915064
Quadratic minimum step length (  0.743521351810) accepted
 2    -39.34776918802651 0.02732338520 0.02169538857 0.7435  0.287   20.00000000
      ideal mu1:      -0.000000000011
 3    -39.36629433649371 0.01546632667 0.01547273559 0.0000  0.000   20.00000000
Finished density kernel iterations (   3)

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00186924006229              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.19138656E-01     0.75790863E-02
               2       0.10300486E-03     0.47672648E-04
               3       0.48278331E-08     0.23563899E-08
               4       0.18518224E-14     0.12212453E-14
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.28953814E-01     0.11775337E-01
               2       0.24596573E-03     0.10762917E-03
               3       0.25794147E-07     0.12082190E-07
               4       0.16353705E-14     0.72164497E-15
================================================================================
RMS gradient                =       0.00186924006229
Trial step length           =               0.245995
Gradient along search dir.  =         -0.24225986821
Functional at step 0        =     -39.36629433649371
Functional at step 1        =     -39.41354883125901
Functional predicted        =     -39.43824425015780
Selected quadratic step     =               0.593990
Conjugate gradients coeff.  =               0.111413
--------------------------- NGWF line search finished --------------------------
                                               

################################################################################
########################### NGWF CG iteration  003 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:      20.09066003
     Final electron number for spin 1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.003240 (step -0.4937 Ne1=     20.0000)
 RMS occupancy error at iteration   2:  0.000017 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<< LNV (Millam-Scuseria variant) density kernel optimisation >>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.000000000801
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.438864407461
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.013598673304
   RMS gradient:       0.007288334350
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.677962298846
             Q1:     -39.443250507487
 Quadratic coef:       0.004833287788
 Linear coef   :      -0.009219387815
           Qmin:     -39.443260851217
Quadratic minimum step length (  0.646598922994) accepted
 1    -39.43886440746083 0.00000000000 0.01117969181 0.6466  0.000   20.00000000
      ideal mu1:       0.000000000000
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.443268703912
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.003403626424
   RMS gradient:       0.003638505689
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.662094926928
             Q1:     -39.444522352355
 Quadratic coef:       0.000999875345
 Linear coef   :      -0.002253523789
           Qmin:     -39.444538454559
Quadratic minimum step length (  0.746116341190) accepted
 2    -39.44326870391164 0.00706511607 0.00639094549 0.7461  0.249   20.00000000
      ideal mu1:       0.000000000000
 3    -39.44454322838522 0.00406330737 0.00379472368 0.0000  0.000   20.00000000
Finished density kernel iterations (   3)

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00074799566336              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13751710E-01     0.39526310E-02
               2       0.67329495E-04     0.20364585E-04
               3       0.24526380E-08     0.87574170E-09
               4       0.13715137E-14     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.89234306E-02     0.26269608E-02
               2       0.29718790E-04     0.10665930E-04
               3       0.50468269E-09     0.21295454E-09
               4       0.15065135E-14     0.88817842E-15
================================================================================
RMS gradient                =       0.00074799566336
Trial step length           =               0.382255
Gradient along search dir.  =         -0.04231366649
Functional at step 0        =     -39.44454322838522
Functional at step 1        =     -39.45567509215887
Functional predicted        =     -39.45751325277634
Selected quadratic step     =               0.613042
Conjugate gradients coeff.  =               0.160128
--------------------------- NGWF line search finished --------------------------
                                               

################################################################################
########################### NGWF CG iteration  004 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:      20.02454558
     Final electron number for spin 1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001281 (step -0.4985 Ne1=     20.0000)
 RMS occupancy error at iteration   2:  0.000005 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<< LNV (Millam-Scuseria variant) density kernel optimisation >>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.000000000063
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.457609251451
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.001517059664
   RMS gradient:       0.002434340632
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.702851224940
             Q1:     -39.457745110376
 Quadratic coef:       0.000930408319
 Linear coef   :      -0.001066267243
           Qmin:     -39.457914742549
Quadratic minimum step length (  0.402741045538) accepted
 1    -39.45760925145119 0.00000000000 0.00413600226 0.4027  0.000   20.00000000
      ideal mu1:       0.000000000000
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.457914367346
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000152320559
   RMS gradient:       0.000771749626
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.532040446949
             Q1:     -39.457974282058
 Quadratic coef:       0.000021125987
 Linear coef   :      -0.000081040698
           Qmin:     -39.457992086731
Quadratic minimum step length (  1.020471374335) accepted
 2    -39.45791436734613 0.00133093787 0.00140775094 1.0205  0.101   20.00000000
      ideal mu1:       0.000000000000
 3    -39.45799201786663 0.00102867696 0.00109528342 0.0000  0.000   20.00000000
Finished density kernel iterations (   3)

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00038441828212              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.14512906E-01     0.35794973E-02
               2       0.96700908E-04     0.25440624E-04
               3       0.62887878E-08     0.18510885E-08
               4       0.23556964E-14     0.88817842E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.68697793E-02     0.18494454E-02
               2       0.22529758E-04     0.65019550E-05
               3       0.35452896E-09     0.11142332E-09
               4       0.17050961E-14     0.66613381E-15
================================================================================
RMS gradient                =       0.00038441828212
Trial step length           =               0.484085
Gradient along search dir.  =         -0.01136168701
Functional at step 0        =     -39.45799201786663
Functional at step 1        =     -39.46157350559502
Functional predicted        =     -39.46193386120918
Selected quadratic step     =               0.693883
Conjugate gradients coeff.  =               0.264125
--------------------------- NGWF line search finished --------------------------
                                               

################################################################################
########################### NGWF CG iteration  005 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:      20.02196717
     Final electron number for spin 1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001157 (step -0.4984 Ne1=     20.0000)
 RMS occupancy error at iteration   2:  0.000004 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<< LNV (Millam-Scuseria variant) density kernel optimisation >>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.000000000076
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.462005064995
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000591939567
   RMS gradient:       0.001520613012
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.736839226765
             Q1:     -39.462047607917
 Quadratic coef:       0.000393621371
 Linear coef   :      -0.000436164293
           Qmin:     -39.462125891317
Quadratic minimum step length (  0.408238708616) accepted
 1    -39.46200506499461 0.00000000000 0.00249669275 0.4082  0.000   20.00000000
      ideal mu1:       0.000000000000
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.462125786683
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000061424606
   RMS gradient:       0.000489913140
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.548458106323
             Q1:     -39.462145708886
 Quadratic coef:       0.000013766620
 Linear coef   :      -0.000033688823
           Qmin:     -39.462146396985
Quadratic minimum step length (  0.671076436238) accepted
 2    -39.46212578668253 0.00084456632 0.00082015751 0.6711  0.104   20.00000000
      ideal mu1:       0.000000000000
 3    -39.46214650126377 0.00049413619 0.00057590054 0.0000  0.000   20.00000000
Finished density kernel iterations (   3)

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00021300037069              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       26.06428106272454 |
           | Pseudopotential (local)    :     -145.91716136045010 |
           | Pseudopotential (non-local):        7.82208851414608 |
           | Hartree                    :       57.55289780696832 |
           | Exchange-correlation       :       -9.47610413087836 |
           | Ewald                      :       24.49185160622569 |
           | Total                      :      -39.46214650126379 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :     -145.91716136041520 |
           | Hartree                    :       57.55289780695335 |
           --------------------------------------------------------
           Integrated density           :       20.00000000000021
           Integrated density tr(KS)    :       20.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.15419122E-01     0.39766992E-02
               2       0.12080721E-03     0.38587508E-04
               3       0.10161617E-07     0.33847922E-08
               4       0.17955990E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.19919917E-02     0.48588265E-03
               2       0.20930574E-05     0.66113623E-06
               3       0.31635459E-11     0.10698551E-11
               4       0.14245850E-14     0.66613381E-15
================================================================================
RMS gradient                =       0.00021300037069
Trial step length           =               0.579568
Gradient along search dir.  =         -0.00358167105
Functional at step 0        =     -39.46214650126377
Functional at step 1        =     -39.46329565557298
Functional predicted        =     -39.46330901019767
Selected quadratic step     =               0.649143
Conjugate gradients coeff.  =               0.307010
--------------------------- NGWF line search finished --------------------------
                                               

################################################################################
########################### NGWF CG iteration  006 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:      20.01242609
     Final electron number for spin 1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000779 (step -0.4990 Ne1=     20.0000)
 RMS occupancy error at iteration   2:  0.000002 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<< LNV (Millam-Scuseria variant) density kernel optimisation >>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.000000000030
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463342362521
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000188436588
   RMS gradient:       0.000857951293
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.606677271222
             Q1:     -39.463376564995
 Quadratic coef:       0.000080117722
 Linear coef   :      -0.000114320195
           Qmin:     -39.463383143471
Quadratic minimum step length (  0.432834724992) accepted
 1    -39.46334236252124 0.00000000000 0.00143259307 0.4328  0.000   20.00000000
      ideal mu1:       0.000000000000
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463383129870
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000026843553
   RMS gradient:       0.000323801940
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.512436327604
             Q1:     -39.463392801598
 Quadratic coef:       0.000004083883
 Linear coef   :      -0.000013755612
           Qmin:     -39.463394713015
Quadratic minimum step length (  0.863011325491) accepted
 2    -39.46338312986959 0.00050963216 0.00054977114 0.8630  0.142   20.00000000
      ideal mu1:       0.000000000000
 3    -39.46339471309171 0.00040697894 0.00049937182 0.0000  0.000   20.00000000
Finished density kernel iterations (   3)

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00011871628109              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.13723123E-01     0.40961154E-02
               2       0.99125386E-04     0.36324095E-04
               3       0.68385046E-08     0.24910607E-08
               4       0.15158636E-14     0.52735594E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.66466796E-03     0.19025312E-03
               2       0.24099870E-06     0.86993930E-07
               3       0.41915570E-13     0.15230872E-13
================================================================================
RMS gradient                =       0.00011871628109
Trial step length           =               0.613370
Gradient along search dir.  =         -0.00113429194
Functional at step 0        =     -39.46339471309171
Functional at step 1        =     -39.46372594164570
Functional predicted        =     -39.46372670140943
Selected quadratic step     =               0.585367
Conjugate gradients coeff.  =               0.310642
--------------------------- NGWF line search finished --------------------------
                                               

################################################################################
########################### NGWF CG iteration  007 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:      20.00554990
     Final electron number for spin 1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000498 (step -0.4995 Ne1=     20.0000)
 RMS occupancy error at iteration   2:  0.000001 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<< LNV (Millam-Scuseria variant) density kernel optimisation >>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.000000000006
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463740167527
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000065086162
   RMS gradient:       0.000504224971
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.665010040763
             Q1:     -39.463751199570
 Quadratic coef:       0.000032250909
 Linear coef   :      -0.000043282951
           Qmin:     -39.463754689706
Quadratic minimum step length (  0.446244747292) accepted
 1    -39.46374016752713 0.00000000000 0.00086334910 0.4462  0.000   20.00000000
      ideal mu1:       0.000000000000
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463754685564
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000014098699
   RMS gradient:       0.000234675404
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.544754291022
             Q1:     -39.463760524160
 Quadratic coef:       0.000001841731
 Linear coef   :      -0.000007680327
           Qmin:     -39.463762692627
Quadratic minimum step length (  1.135858385034) accepted
 2    -39.46375468556433 0.00030164082 0.00040866830 1.1359  0.217   20.00000000
      ideal mu1:       0.000000000000
 3    -39.46376269043430 0.00037390769 0.00042654462 0.0000  0.000   20.00000000
Finished density kernel iterations (   3)

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00006651561359              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.66488237E-02     0.22200605E-02
               2       0.20582874E-04     0.87548982E-05
               3       0.24590575E-09     0.10196355E-09
               4       0.17303789E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.17176822E-03     0.56272869E-04
               2       0.14176156E-07     0.59574616E-08
               3       0.15392242E-14     0.44408921E-15
================================================================================
RMS gradient                =       0.00006651561359
Trial step length           =               0.599205
Gradient along search dir.  =         -0.00033157675
Functional at step 0        =     -39.46376269043430
Functional at step 1        =     -39.46385948173803
Functional predicted        =     -39.46385954554884
Selected quadratic step     =               0.584209
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               

################################################################################
########################### NGWF CG iteration  008 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:      20.00243839
     Final electron number for spin 1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000252 (step -0.4996 Ne1=     20.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<< LNV (Millam-Scuseria variant) density kernel optimisation >>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:       0.000000000000
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463862962861
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000011495868
   RMS gradient:       0.000211909733
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.786615362958
             Q1:     -39.463866014726
 Quadratic coef:       0.000005990961
 Linear coef   :      -0.000009042826
           Qmin:     -39.463866375198
Quadratic minimum step length (  0.593663168580) accepted
 1    -39.46386296286116 0.00000000000 0.00037598742 0.5937  0.000   20.00000000
      ideal mu1:       0.000000000000
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463866374876
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000008958514
   RMS gradient:       0.000187062397
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.683362692007
             Q1:     -39.463871647458
 Quadratic coef:       0.000000849333
 Linear coef   :      -0.000006121914
           Qmin:     -39.463877406427
Quadratic minimum step length (  2.462808170403) accepted
 2    -39.46386637487629 0.00015882693 0.00033628582 2.4628  0.779   20.00000000
      ideal mu1:       0.000000000000
 3    -39.46387733796635 0.00070072744 0.00031413257 0.0000  0.000   20.00000000
Finished density kernel iterations (   3)

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00003546117925              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.83131524E-02     0.27744626E-02
               2       0.31546062E-04     0.13417729E-04
               3       0.57570483E-09     0.23873570E-09
               4       0.13831526E-14     0.45818384E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.29850146E-02     0.98253398E-03
               2       0.41645909E-05     0.17554532E-05
               3       0.10451609E-10     0.42945647E-11
               4       0.17217800E-14     0.77715612E-15
================================================================================
RMS gradient                =       0.00003546117925
Trial step length           =               0.591659
Gradient along search dir.  =         -0.00010134063
Functional at step 0        =     -39.46387733796635
Functional at step 1        =     -39.46389109740234
Functional predicted        =     -39.46389679208801
Selected quadratic step     =               0.383935
Conjugate gradients coeff.  =               0.284223
--------------------------- NGWF line search finished --------------------------
                                               

################################################################################
########################### NGWF CG iteration  009 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:      20.00196590
     Final electron number for spin 1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000208 (step -0.4996 Ne1=     20.0000)
 RMS occupancy error at iteration   2:  0.000000 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<< LNV (Millam-Scuseria variant) density kernel optimisation >>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:       0.000000000000
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463899113484
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000005915329
   RMS gradient:       0.000152009053
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       1.297301515155
             Q1:     -39.463895933817
 Quadratic coef:       0.000010853632
 Linear coef   :      -0.000007673965
           Qmin:     -39.463900469936
Quadratic minimum step length (  0.458622814918) accepted
 1    -39.46389911348407 0.00000000000 0.00025419479 0.4586  0.000   20.00000000
      ideal mu1:       0.000000000000
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463900469576
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000001532044
   RMS gradient:       0.000077367273
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.771344328220
             Q1:     -39.463901139166
 Quadratic coef:       0.000000512144
 Linear coef   :      -0.000001181733
           Qmin:     -39.463901151266
Quadratic minimum step length (  0.889908835340) accepted
 2    -39.46390046957649 0.00009191547 0.00013410833 0.8899  0.259   20.00000000
      ideal mu1:       0.000000000000
 3    -39.46390115127448 0.00010296533 0.00010779790 0.0000  0.000   20.00000000
Finished density kernel iterations (   3)

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00001687176596              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
WARNING: slope along search direction is positive:    0.243887E-04
         Resetting conjugate gradients!
WARNING: slope along search direction is still positive.
         Reversing search direction!!
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.43905163E-02     0.15250457E-02
               2       0.83850336E-05     0.35143173E-05
               3       0.34518729E-10     0.14096946E-10
               4       0.14312316E-14     0.44408921E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.18431220E-02     0.64234145E-03
               2       0.14696625E-05     0.61463455E-06
               3       0.10459157E-11     0.42454928E-12
================================================================================
RMS gradient                =       0.00001687176596
Trial step length           =               0.476612
Gradient along search dir.  =         -0.00002133330
Functional at step 0        =     -39.46390115127448
Functional at step 1        =     -39.46390249935636
Functional predicted        =     -39.46390408173443
Selected quadratic step     =               0.274731
Conjugate gradients coeff.  =              -0.226368
--------------------------- NGWF line search finished --------------------------
                                               

################################################################################
########################### NGWF CG iteration  010 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:      19.99884078
     Final electron number for spin 1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000114 (step -0.5002 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<< LNV (Millam-Scuseria variant) density kernel optimisation >>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.000000038353
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463904758434
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000003425439
   RMS gradient:       0.000115674636
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.828508378215
             Q1:     -39.463905680705
 Quadratic coef:       0.000001915734
 Linear coef   :      -0.000002838005
           Qmin:     -39.463905809502
Quadratic minimum step length (  0.613684029346) accepted
 1    -39.46390475843368 0.00000000000 0.00017111289 0.6137  0.000   20.00000000
      ideal mu1:       0.000000000000
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463905809553
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000000669063
   RMS gradient:       0.000051123119
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.713051442667
             Q1:     -39.463906129167
 Quadratic coef:       0.000000157462
 Linear coef   :      -0.000000477077
           Qmin:     -39.463906170912
Quadratic minimum step length (  1.080194959140) accepted
 2    -39.46390580955281 0.00010731601 0.00009254462 1.0802  0.195   20.00000000
      ideal mu1:       0.000000000000
 3    -39.46390617093824 0.00007434102 0.00010481884 0.0000  0.000   20.00000000
Finished density kernel iterations (   3)

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000735903058              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       26.01570698988894 |
           | Pseudopotential (local)    :     -145.82395340183900 |
           | Pseudopotential (non-local):        7.82467683596649 |
           | Hartree                    :       57.49359084819161 |
           | Exchange-correlation       :       -9.46577904937192 |
           | Ewald                      :       24.49185160622569 |
           | Total                      :      -39.46390617093823 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :     -145.82395340180270 |
           | Hartree                    :       57.49359084817618 |
           --------------------------------------------------------
           Integrated density           :       19.99999999999999
           Integrated density tr(KS)    :       20.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
WARNING: slope along search direction is positive:    0.222724E-05
         Resetting conjugate gradients!
WARNING: slope along search direction is still positive.
         Reversing search direction!!
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.34253475E-02     0.11839017E-02
               2       0.50700342E-05     0.20921867E-05
               3       0.12698033E-10     0.50686122E-11
               4       0.14555912E-14     0.59674488E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.31072841E-02     0.10744110E-02
               2       0.41704101E-05     0.17203949E-05
               3       0.85815190E-11     0.34210412E-11
               4       0.13180755E-14     0.44408921E-15
================================================================================
RMS gradient                =       0.00000735903058
Trial step length           =               0.361856
Gradient along search dir.  =         -0.00000405862
Functional at step 0        =     -39.46390617093824
Functional at step 1        =     -39.46389966639708
Functional predicted        =     -39.46390623856794
Selected quadratic step     =               0.033326
Conjugate gradients coeff.  =               0.190248
--------------------------- NGWF line search finished --------------------------
                                               

################################################################################
########################### NGWF CG iteration  011 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:      19.99986480
     Final electron number for spin 1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000014 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<< LNV (Millam-Scuseria variant) density kernel optimisation >>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.000000000746
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463906248717
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000001106654
   RMS gradient:       0.000065748503
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.877630089489
             Q1:     -39.463906255042
 Quadratic coef:       0.000000964908
 Linear coef   :      -0.000000971233
           Qmin:     -39.463906493117
Quadratic minimum step length (  0.441691317199) accepted
 1    -39.46390624871697 0.00000000000 0.00011448940 0.4417  0.000   20.00000000
      ideal mu1:       0.000000000000
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463906493131
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000000348076
   RMS gradient:       0.000036873211
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.622608697530
             Q1:     -39.463906674020
 Quadratic coef:       0.000000035825
 Linear coef   :      -0.000000216715
           Qmin:     -39.463906820868
Quadratic minimum step length (  1.883138877030) accepted
 2    -39.46390649313081 0.00003843475 0.00006651632 1.8831  0.315   20.00000000
      ideal mu1:       0.000000000000
 3    -39.46390682083101 0.00009230082 0.00008593994 0.0000  0.000   20.00000000
Finished density kernel iterations (   3)

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000345924002              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12989242E-02     0.44658536E-03
               2       0.74415033E-06     0.30860296E-06
               3       0.28869534E-12     0.11612933E-12
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12496305E-02     0.42961037E-03
               2       0.68869905E-06     0.28563415E-06
               3       0.24694659E-12     0.98809849E-13
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.11736477E-06     0.40448730E-07
               2       0.64081290E-14     0.26645353E-14
================================================================================
RMS gradient                =       0.00000345924002
Trial step length           =               0.109815
Gradient along search dir.  =         -0.00000081636
Functional at step 0        =     -39.46390682083101
Functional at step 1        =     -39.46390572838106
Rejected quadratic step     =               0.004164
Functional at new step 1    =     -39.46390682253480
Functional predicted        =     -39.46390682253480
Selected quadratic step     =               0.004174
Conjugate gradients coeff.  =              -0.220963
--------------------------- NGWF line search finished --------------------------
                                               

################################################################################
########################### NGWF CG iteration  012 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:      20.00002070
     Final electron number for spin 1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<< LNV (Millam-Scuseria variant) density kernel optimisation >>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.000000000018
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463906822774
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000000639567
   RMS gradient:       0.000049983065
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       1.082801294558
             Q1:     -39.463906852063
 Quadratic coef:       0.000000663234
 Linear coef   :      -0.000000692523
           Qmin:     -39.463907003550
Quadratic minimum step length (  0.565309965409) accepted
 1    -39.46390682277354 0.00000000000 0.00008482985 0.5653  0.000   20.00000000
      ideal mu1:       0.000000000000
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463907003551
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000000156302
   RMS gradient:       0.000024709417
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.782379934796
             Q1:     -39.463907073832
 Quadratic coef:       0.000000052007
 Linear coef   :      -0.000000122288
           Qmin:     -39.463907075437
Quadratic minimum step length (  0.919837981324) accepted
 2    -39.46390700355091 0.00003982240 0.00004394707 0.9198  0.244   20.00000000
      ideal mu1:       0.000000000000
 3    -39.46390707543904 0.00003091868 0.00004408294 0.0000  0.000   20.00000000
Finished density kernel iterations (   3)

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000410275696              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.14840247E-03     0.51277263E-04
               2       0.96743110E-08     0.40270371E-08
               3       0.16578670E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.10840821E-03     0.37460877E-04
               2       0.51618740E-08     0.21487085E-08
               3       0.15883381E-14     0.66613381E-15
================================================================================
RMS gradient                =       0.00000410275696
Trial step length           =               0.021410
Gradient along search dir.  =         -0.00000039770
Functional at step 0        =     -39.46390707543904
Functional at step 1        =     -39.46390706815021
Functional predicted        =     -39.46390707658595
Selected quadratic step     =               0.005768
Conjugate gradients coeff.  =              -1.406663
--------------------------- NGWF line search finished --------------------------
                                               

################################################################################
########################### NGWF CG iteration  013 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:      19.99998284
     Final electron number for spin 1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<< LNV (Millam-Scuseria variant) density kernel optimisation >>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.000000000012
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463907076741
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000000178317
   RMS gradient:       0.000026392238
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.848329405273
             Q1:     -39.463907112213
 Quadratic coef:       0.000000115800
 Linear coef   :      -0.000000151271
           Qmin:     -39.463907126143
Quadratic minimum step length (  0.554094320569) accepted
 1    -39.46390707674108 0.00000000000 0.00004467767 0.5541  0.000   20.00000000
      ideal mu1:       0.000000000000
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463907126144
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000000094996
   RMS gradient:       0.000019263200
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.685605211061
             Q1:     -39.463907175450
 Quadratic coef:       0.000000015824
 Linear coef   :      -0.000000065130
           Qmin:     -39.463907193162
Quadratic minimum step length (  1.410971920115) accepted
 2    -39.46390712614392 0.00001937132 0.00003463225 1.4110  0.533   20.00000000
      ideal mu1:       0.000000000000
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463907193169
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000000133330
   RMS gradient:       0.000022820480
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.983549541758
             Q1:     -39.463907286727
 Quadratic coef:       0.000000037579
 Linear coef   :      -0.000000131137
           Qmin:     -39.463907307574
Quadratic minimum step length (  1.716114272592) accepted
 3    -39.46390719316869 0.00003919260 0.00003685204 1.7161  1.403   20.00000000
      ideal mu1:       0.000000000000
 4    -39.46390730751674 0.00007728367 0.00000768065 0.0000  0.000   20.00000000
Finished density kernel iterations (   4)

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00000324751829              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
WARNING: slope along search direction is positive:    0.826486E-06
         Resetting conjugate gradients!
WARNING: slope along search direction is still positive.
         Reversing search direction!!
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.10679379E-03     0.36762344E-04
               2       0.50142150E-08     0.20801685E-08
               3       0.15308295E-14     0.66613381E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.49094390E-04     0.16901974E-04
               2       0.10594711E-08     0.43953796E-09
               3       0.15636430E-14     0.44408921E-15
================================================================================
RMS gradient                =       0.00000324751829
Trial step length           =               0.011112
Gradient along search dir.  =         -0.00000079039
Functional at step 0        =     -39.46390730751674
Functional at step 1        =     -39.46390730817005
Functional predicted        =     -39.46390730988896
Selected quadratic step     =               0.006003
Conjugate gradients coeff.  =               0.626544
--------------------------- NGWF line search finished --------------------------
                                               

################################################################################
########################### NGWF CG iteration  014 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:      19.99997593
     Final electron number for spin 1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000002 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<< LNV (Millam-Scuseria variant) density kernel optimisation >>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.000000000024
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463907310215
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000000005579
   RMS gradient:       0.000004668180
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       1.299185670492
             Q1:     -39.463907308042
 Quadratic coef:       0.000000009421
 Linear coef   :      -0.000000007248
           Qmin:     -39.463907311609
Quadratic minimum step length (  0.499743050654) accepted
 1    -39.46390731021516 0.00000000000 0.00000767120 0.4997  0.000   20.00000000
      ideal mu1:       0.000000000000
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463907311609
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000000000301
   RMS gradient:       0.000001084287
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.805766101507
             Q1:     -39.463907311646
 Quadratic coef:       0.000000000205
 Linear coef   :      -0.000000000243
           Qmin:     -39.463907311681
Quadratic minimum step length (  0.476185929559) accepted
 2    -39.46390731160886 0.00000347093 0.00000178944 0.4762  0.054   20.00000000
      ideal mu1:       0.000000000000
-mu(2tr(KS)-Ne):       0.000000000000
             Q0:     -39.463907311681
DltNe tr(Dir*S):       0.000000000000
             G0:      -0.000000000039
   RMS gradient:       0.000000387977
-mu(2tr(KS)-Ne):       0.000000000000
     Trial step:       0.619430770993
             Q1:     -39.463907311690
 Quadratic coef:       0.000000000016
 Linear coef   :      -0.000000000024
           Qmin:     -39.463907311691
Quadratic minimum step length (  0.472826651943) accepted
 3    -39.46390731168143 0.00000072880 0.00000063248 0.4728  0.128   20.00000000
      ideal mu1:       0.000000000000
 4    -39.46390731168982 0.00000029003 0.00000024220 0.0000  0.000   20.00000000
Finished density kernel iterations (   4)

           ........................................................
           | *** NGWF optimisation converged ***                  |
           | RMS NGWF gradient =    0.00000074600134              |
           | Criteria satisfied:                                  |
           | -> RMS NGWF gradient lower than set threshold.       |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       26.01598927116057 |
           | Pseudopotential (local)    :     -145.82405698796060 |
           | Pseudopotential (non-local):        7.82420012443264 |
           | Hartree                    :       57.49388812832843 |
           | Exchange-correlation       :       -9.46577945387650 |
           | Ewald                      :       24.49185160622569 |
           | Total                      :      -39.46390731168978 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :     -145.82405698792860 |
           | Hartree                    :       57.49388812831234 |
           --------------------------------------------------------
           Integrated density           :       19.99999999999959
           Integrated density tr(KS)    :       19.99999999999999
================================================================================


                    <<<<< CALCULATION SUMMARY >>>>>
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   1     0.00560011692877    -38.69416911499025   0.494093    -39.27481267254645
   2     0.00186924006229    -39.36629433649371   0.593990    -39.43824425015780
   3     0.00074799566336    -39.44454322838522   0.613042    -39.45751325277634
   4     0.00038441828212    -39.45799201786663   0.693883    -39.46193386120918
   5     0.00021300037069    -39.46214650126377   0.649143    -39.46330901019767
   6     0.00011871628109    -39.46339471309171   0.585367    -39.46372670140943
   7     0.00006651561359    -39.46376269043430   0.584209    -39.46385954554884
   8     0.00003546117925    -39.46387733796635   0.383935    -39.46389679208801
   9     0.00001687176596    -39.46390115127448   0.274731    -39.46390408173443
  10     0.00000735903058    -39.46390617093824   0.033326    -39.46390623856794
  11     0.00000345924002    -39.46390682083101   0.004174    -39.46390682253480
  12     0.00000410275696    -39.46390707543904   0.005768    -39.46390707658595
  13     0.00000324751829    -39.46390730751674   0.006003    -39.46390730988896
  14     0.00000074600134    -39.46390731168982  <-- CG                         
 
<QC>        [NGWF iterations]:       14
<QC>           [total_energy]:      -39.46390731
<QC>                     [F0]:      -39.46390731
<QC>                     [F1]:      -39.46390731
<QC>                     [F2]:        0.00000000
<QC>   [predicted_functional]:      -39.46390731
<QC>           [rms_gradient]:        0.000000746001
<QC>                 [G_init]:       -0.000000790388
<QC>        [quadratic_coeff]:        0.006003
<QC>            [cubic_coeff]:        0.000000
<QC>               [cg_coeff]:        0.626544
<QC>           [trial_length]:        0.011112

------------------------------ TIMING INFORMATION ------------------------------
TOTAL TIME:     443.613s on     4 node(s)

Job completed: 28-05-2011 00:09 (+0100)

Application 646100 resources: utime ~1716s, stime ~59s
