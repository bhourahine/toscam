module smooth_data

   use fourier_transform_mod

   use genvar

   private

! contains
!
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
!
! SUBROUTINE SMOOFT(Y,N,PTS,NMAX)
! !---------------------------------------------------------------
! ! Smooths an array Y of length N, with a window whose full width
! ! is of order PTS neighboring points, a user supplied value.
! ! Array Y is modified.
! !---------------------------------------------------------------
! REAL :: Y(NMAX)
!
!   M=2
!   NMIN=N+2.*PTS
! 1 IF (M.LT.NMIN) THEN
!     M=2*M
!     GO TO 1
!   END IF
!   print *,' M=',M
!   IF (M.GT.NMAX) then
!    write(*,*) 'M,NMAX : ', M,NMAX
!    stop ' Sample too big.'
!   endif
!   CONST=(PTS/M)**2
!   Y1=Y(1)
!   YN=Y(N)
!   RN1=1./(N-1)
!   DO J=1, N             !Remove linear trend
!     Y(J)=Y(J)-RN1*(Y1*(N-J)+YN*(J-1))
!   END DO
!   IF (N+1.LE.M) THEN
!     DO J=N+1, M
!       Y(J)=0.
!     END DO
!   END IF
!   MO2=M/2
!   CALL REALFT(Y,MO2,1)  !Fourier transform
!   Y(1)=Y(1)/MO2
!   FAC=1.
!   DO J=1, MO2-1
!     K=2*J+1
!     IF (FAC.NE.0.) THEN
!       FAC=AMAX1(0.,(1.-CONST*J**2)/MO2)
!       Y(K)=FAC*Y(K)
!       Y(K+1)=FAC*Y(K+1)
!     ELSE
!       Y(K)=0.
!       Y(K+1)=0.
!     END IF
!   END DO
!   FAC=AMAX1(0.,(1.-0.25*PTS**2)/MO2)  !Last point
!   Y(2)=FAC*Y(2)
!   CALL REALFT(Y,MO2,-1)  !Inverse Fourier transform
!   DO J=1, N              !Restore linear trend
!     Y(J)=RN1*(Y1*(N-J)+YN*(J-1))+Y(J)
!   END DO
!   RETURN
! END subroutine
!
!
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************
! !**************************************************************************

end module
