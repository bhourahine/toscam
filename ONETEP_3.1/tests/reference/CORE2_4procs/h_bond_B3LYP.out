 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                              Version 3.0 RC1  |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Peter D. Haynes, Nicholas D. M. Hine, Arash. A. Mostofi,     |
 |  Mike C. Payne and Chris-Kriton Skylaris                      |
 |                                                               |
 |  Contributors:                                                |
 |  P. W. Avraam, S. J. Clark, O. Dieguez, S. M. M. Dubois,      |
 |  J. Dziedzic, H. H. Helal, Q. O. Hill, D. D. O`Regan,         |
 |  C. J. Pickard, M. I. J. Probert, L. Ratcliff, M. Robinson    |
 |  and A. Ruiz Serrano                                          |
 |                                                               |
 |                                   Copyright (c) 2004-2011     |
 |                                                               |
 |  Please cite:                                                 |
 |  "Introducing ONETEP: Linear-scaling density functional       |
 |   simulations on parallel computers".                         |
 |   C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, M. C. Payne.   |
 |   J. Chem. Phys. 122 084119 (2005).                           |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 20-06-2011 12:16 (+0100)

Running on     4 processors.

Reading parameters from file "h_bond_B3LYP.dat" ...... done
Reading geometry and species blocks from file "h_bond_B3LYP.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to AUTO
    
... done
-------------------------------------------------------------------------------
---------------------------- RUN-TIME PARAMETERS ------------------------------
-------------------------------------------------------------------------------
task                      : SINGLEPOINT *! Type of calculation (String)         
cutoffenergy              : 11.0246982673597      hartree *! Plane wave kinetic 
kernelcutoff              : 1000.00000000000 *! Density kernel radius in Bohr ( 
xcfunctional              : B3LYP *! Exchange-correlation functional (String)   
libxcxfuncid              : 0 *! Functional identifier for which exchange funct 
libxccfuncid              : 0 *! Functional identifier for which correlation fu 
charge                    : 0.000000000000000E+000 *! The total charge of the s 
spin                      : 0 *! Total spin of system (Integer)                 
spinpolarized             : F *! Switch for spin polarization (Boolean)         
spinpolarised             : F *! Switch for spin polarisation (Boolean)         
constantefield            : 0.0 0.0 0.0 *! Cartesian coordinates of constant el 
fftboxpref                : 0 0 0 *! Preferred FFT box dimensions (String)      
ppdnpoints                : 0 0 0 *! PPD edge length in grid points for each la 
psincspacing              : 0.0 0.0 0.0 *! PSINC grid spacing in atomic units ( 
oldinput                  : F *! Read old-format input file (Boolean)           
develcode                 : *! For development code only (String)               
nnho                      : F *! Initialise NGWFs to nonorthogonal natural hybr 
ngwfhalo                  : -1.00000000000000 *! Halo extension to NGWF radii ( 
nonscforces               : F *! Include non self-consistent forces due to NGWF 
maxitpalsermano           : 50 *! Maximum number of iterations for Palser-Manol 
maxitpen                  : 0 *! Max number of penalty functional iterations (I 
penparam                  : 4.00000000000000 *! Penalty functional parameter (D 
minitlnv                  : 2 *! Min number of LNV iterations (Integer)         
maxitlnv                  : 2 *! Max number of LNV iterations (Integer)         
maxitlnvcoarse            : 0 *! Max number of low-accuracy LNV iterations (Int 
lnvthresholdorig          : 1.000000000000000E-009 *! LNV convergence threshold 
lnvcgtype                 : LNV_FLETCHER *! Type of CG coefficient for LNV dens 
lnvcgmaxstep              : 3.00000000000000 *! Maximum length of trial step fo 
exactlnv                  : T *! Use original LNV algorithm (Boolean)           
oldlnv                    : F *! Use LNV algorithm backwards compatible pre Dec 
lnvchecktrialsteps        : F *! Check stability of kernel at each trial step d 
kerfix                    : 1 *! Density kernel fixing approach (Integer)       
maxitkernelfix            : 3 *! Maximum # iterations of Penalty Functional ide 
initialdensrealspace      : F *! Construct initial density in real space from a 
kerneldiis                : F *! Use kernel DIIS in the inner loop (Boolean)    
kerneldiistype            : P *! Density mixing method (String)                 
kerneldiismax             : 10 *! Max number of kernels saved during kernel DII 
kerneldiismaxit           : 25 *! Max number of kernel DIIS iterations (Integer 
kerneldiisthres           : 1.000000000000000E-009 *! Density mixing convergenc 
kerneldiisliter           : 5 *! Number of linear mixing iterations (Integer)   
kerneldiiscin             : 0.900000000000000 *! Coefficient for the input kern 
kerneldiiscriteria        : 1000 *! Density mixing convergence criteria (String 
maxitngwfcg               : 1 *! Max number of NGWF conjugate gradients (CG) it 
ngwfcgtype                : NGWF_FLETCHER *! Type of CG coefficient for NGWF op 
ngwfcgmaxstep             : -8.00000000000000 *! Maximum length of trial step f 
eleccgmax                 : 5 *! Number of NGWF iterations to reset CG (Integer 
precondscheme             : TETER *! Recip-space preconditioning scheme (String 
kzero                     : 3.00000000000000 *! KE preconditioning parameter (D 
rprecond                  : 2.00000000000000 *! Radial cut-off for real-space p 
precondrecip              : T *! Recip-space KE preconditioning (Boolean)       
precondreal               : F *! Real-space KE preconditioning (Boolean)        
smoothscheme              : NONE *! Smoothing scheme for the NGWF gradients at  
rsmooth                   : 1.50000000000000      bohr *! Radius of the unshave 
ksmooth                   : 5.00000000000000 *! Characteristic wavelength of th 
occmix                    : 0.250000000000000 *! Mix fraction of occupancy prec 
kernelupdate              : F *! Update density kernel during NGWF line search  
kernelchristoffelupdate   : F *! Update density kernel during NGWF line search  
maxithotelling            : 50 *! Number of Hotelling iteration per NGWF change 
maxresidhotelling         : 1.000000000000000E-012 *! Max allowed value in Hote 
maxitngwfdiis             : 0 *! Max number of NGWF DIIS steps (Integer)        
ngwfdiissize              : 4 *! Max size of the DIIS iterative subspace (Integ 
ngwfdiisreset             : 8 *! Max number of iteration for the resetting of D 
ngwfdiismaxstep           : 2.00000000000000 *! Max length of trial step for NG 
ngwfthresholdorig         : 2.000000000000000E-006 *! NGWF convergence threshol 
elecenergytol             : -1.000000000000000E-003 hartree *! Tolerance on tot 
elecforcetol              : -1.000000000000000E-003 ha/bohr *! Tolerance on max 
ngwfmaxgrad               : -2.000000000000000E-005 *! Maximum permissible valu 
deltaeconv                : T *! Use consecutive energy gains as a criterion fo 
locpotintbatchsize        : 10 *! Size of NGWF in fftbox batch for locpot integ 
kineticintbatchsize       : 10 *! Size of NGWF in fftbox batch for kinetic inte 
densitybatchsize          : 10 *! Size of NGWF in fftbox batch for charge densi 
ngwfgradbatchsize         : 10 *! Size of NGWF in fftbox batch for NGWF gradien 
densethreshold            : 0.400000000000000 *! Threshold for matrix segment f 
commsgroupsize            : 4 *! Number of nodes in a group (determines comms e 
ovlpfornonlocal           : F *! Overlap sparsity for nonlocal (Boolean)        
usespacefillingcurve      : T *! Re-arrange atoms according to space-filling cu 
corehamdenskernguess      : T *! Initial guess for density kernel from core Ham 
checkatoms                : T *! Check atoms on top of each other (Boolean)     
locpotscheme              : FULL *! Scheme for evaluating local potential matri 
smoothprojectors          : -0.400000000000000 *! Halfwidth of Gaussian filter  
smoothlocpspot            : -0.400000000000000 *! Halfwidth of Gaussian filter  
oddpsincgrid              : F *! Force odd number of points in simcell psinc gr 
evenpsincgrid             : F *! Force even number of points in simcell psinc g 
realspaceprojectors       : F *! Whether to evaluate and store projectors in re 
outputdetail              : VERBOSE *! Level of output detail (String)          
pawoutputdetail           : DEFAULT *! Level of output detail for PAW: BRIEF, N 
timingslevel              : 1 *! Level of timings output: 0(none) 1(nodes summa 
writeparams               : T *! Output runtime parameters at startup (Boolean) 
writeforces               : F *! Write ionic forces (Boolean)                   
writepositions            : T *! Write ionic positions each geometry or MD step 
writexyz                  : F *! Output coordinates in .xyz file (Boolean)      
printqc                   : T *! Print Quality Control information (Boolean)    
cubeformat                : F *! Allow .cube format for plot outputs (Boolean)  
dxformat                  : F *! Allow .dx format for plot outputs (Boolean)    
dxformatcoarse            : F *! Output only points on the coarse grid (Boolean 
dxformatdigits            : 7 *! Number of significant digits in .dx output (In 
grdformat                 : T *! Allow .grd format for plot outputs (Boolean)   
writedensityplot          : T *! Write the charge density in plotting format (B 
writengwfplot             : F *! Write NGWFs in plotting format (Boolean)       
writengwfgradplot         : F *! Write NGWF Gradients in plotting format (Boole 
writengwfradial           : 0 *! Write NGWFs radial distributions (Integer)     
writengwfgradradial       : 0 *! Write NGWFs gradients radial distributions (In 
writeradialstep           : 5.000000000000000E-003 bohr *! Define the grid step 
writeradialsmear          : 1.000000000000000E-002 bohr *! Define the gaussian  
readdenskern              : F *! Read density kernel restart information (Boole 
writedenskern             : F *! Write density kernel restart information (Bool 
readtightboxngwfs         : F *! Read in universal tightbox NGWFs restart infor 
writetightboxngwfs        : F *! Write in universal tightbox NGWFs restart info 
writeconvergeddkngwfs     : F *! Only write Density Kernel and NGWFs upon conve 
readswngwfs               : F *! Read NGWFs restart information in spherical wa 
writeswngwfs              : F *! Write NGWFs restart information in spherical w 
writemaxl                 : 3 *! Maximum angular momentum number when writing i 
readmaxl                  : 3 *! Maximum angular momentum number when reading i 
extransw                  : 0 *! Maximum number of zeros of the sph Bessel func 
paw                       : F *! Uses a PAW construction to find correct core d 
finegridscale             : 2.00000000000000 *! Ratio of size of fine grid to s 
dblgridscale              : 2.00000000000000 *! Ratio of charge density / poten 
augfuncsrecip             : T *! Construct Augmentation functions in recip spac 
dispersion                : 0 *! Select dispersion correction (Integer)         
vdwdcoeff                 : -1.00000000000000 *! Replacement VDW damping coeffi 
hubbardmaxiter            : 0 *! Maximum number of DFT+U projector optimisation 
hubbardenergytol          : 1.000000000000000E-008 hartree *! Energy tolerance  
hubbardconvwin            : 2 *! Energy convergence window when using DFT+U pro 
hubbardprojmixing         : 0.000000000000000E+000 *! Proportion of old Hubbard 
hubbardfunctional         : 1 *! DFT+U energy functional to use (Integer)       
hubbardtensorcorr         : 1 *! DFT+U projector tensorial correction to use (I 
hubbardngwfspinthreshold  : 2.000000000000000E-005 *! NGWF RMS  gradient thresh 
coulombcutoffradius       : 0.000000000000000E+000 *! Radius of sphere or cylin 
coulombcutofflength       : 0.000000000000000E+000 *! Length of cylinder or wid 
coulombcutofftype         : NONE *! Type of cutoff coulomb interaction: NONE, S 
coulombcutoffwriteint     : F *! Write real-space cutoff Coulomb interaction sc 
pbccorrectioncutoff       : 0.000000000000000E+000 *! alpha*L cutoff parameter  
doproperties              : F *! Allow calculation of properties (Boolean)      
numeigenvalues            : 10 *! Number of energy and occupancy eigenvalues to 
homodensplot              : -1 *! Number of squared MOs to plot from HOMO and l 
lumodensplot              : -1 *! Number of squared MOs to plot from LUMO and h 
homoplot                  : 5 *! Number of MOs to plot from HOMO and lower (Int 
lumoplot                  : 5 *! Number of MOs to plot from LUMO and higher (In 
dossmear                  : 3.674932438755288E-003 hartree *! Half width of sme 
ldossmear                 : 3.674932438755288E-003 hartree *! Lorentzian broade 
popncalculate             : F *! Allow population analysis (Boolean)            
popnbondcutoff            : 5.66917840375065      bohr *! Bond length cutoff fo 
ngwfanalysis              : F *! Perform NGWF analysis (Boolean)                
polarisationcalculate     : F *! Allow calculation of polarisation (Boolean)    
spreadcalculate           : F *! Calculate spread of NGWFs (Boolean)            
geommodulusest            : 1.700000000000000E-002 ha/bohr**3 *! The estimated  
geomfrequencyest          : 7.600000000000000E-003 hartree *! The estimated ave 
geomenergytol             : 1.000000000000000E-006 hartree *! Geometry optimiza 
geomforcetol              : 2.000000000000000E-003 ha/bohr *! Geometry optimiza 
geomdisptol               : 5.000000000000000E-003 bohr *! Geometry optimizatio 
geommaxiter               : 50 *! Maximum number of geometry optimization itera 
geomconvergencewin        : 2 *! Geometry optimization convergence tolerance wi 
geomcontinuation          : F *! Read information for continuation of a previou 
geombackupiter            : 1 *! Number of geometry optimisation iterations bet 
geomresetdkngwfsiter      : 6 *! Number of geom iterations between resets of ke 
geomreusedkngwfs          : T *! Re-use density kernel and NGWFs during geometr 
geomprintinvhessian       : F *! Write inverse Hessian to standard output (Bool 
geommethod                : CARTESIAN *! Method for geometry optimization (Stri 
tssearchmethod            : LSTQST *! Specifies method to be used for TS search 
tssearchlstqstprotocol    : LSTMAXIMUM *! Specifies LSTQST protocol (String)    
tssearchqstmaxiter        : 5 *! Specifies maximum number of QST steps (Integer 
tssearchcgmaxiter         : 20 *! Specifies maximum number of CG steps (Integer 
tssearchforcetol          : 5.000000000000000E-003 ha/bohr *! Force tolerance f 
tssearchdisptol           : 1.000000000000000E-002 bohr *! Displacement toleran 
mddeltat                  : 40.0000000000000      aut *! Molecular dynamics tim 
mdnumiter                 : 100 *! Maximum number of molecular dynamics iterati 
mdtemperature             : 9.500000000000000E-004 hartree *! Temperature for m 
mdalgorithm               : LEAPFROGVERLET *! Integration algorithm for molecul 
mdthermostat              : NONE *! Thermostat for molecular dynamics (String)  
mdcollisionfrequency      : 0.152000000000000      hartree *! Collision frequen 
mixdenskern               : 0 *! Number of coefficients used to build new guess 
mixngwfs                  : 0 *! Number of coefficients used to build new guess 
condreaddenskern          : F *! Read in conduction density kernel (Boolean)    
condreadtightboxngwfs     : F *! Read in universal tightbox conduction NGWFs (B 
condfixedshift            : F *! Fixed projected conduction Hamiltonian shift ( 
condcalcmaxeigen          : T *! Calculate maximum conduction Hamiltonian eigen 
condnumstates             : 0 *! Number of conduction states to be optimised fo 
condkernelcutoff          : 1000.00000000000 *! Conduction density kernel radiu 
condinitshift             : 0.000000000000000E+000 *! Initial shifting factor f 
condshiftbuffer           : 0.100000000000000 *! Additional buffer for updating 
condnumextrastates        : 0 *! Number of extra conduction states for initial  
condnumextraits           : 0 *! Number of NGWF iterations with extra conductio 
condplotjointorbitals     : T *! Plot orbitals in the joint basis following a c 
condplotvcorbitals        : T *! Plot orbitals in the val and cond NGWF basis s 
condcalcopticalspectra    : F *! Calculate matrix elements for optical absorpti 
condspeccalcmommatels     : T *! Calculate momentum matrix elements (default tr 
condspeccalcnonloccomm    : T *! Calculate nonlocal commutator for momentum mat 
condspeccontderiv         : T *! Calculate non-local commuator using continuous 
condspecnonloccommshift   : 1.000000000000000E-004 *! Finite difference shift f 
bskpointpathspacing       : 0.188972700000000      1/bohr *! K-point spacing al 
bsnumeigenvalues          : -1 *! Num of energy and occ. eigenvalues to print b 
bsunfold                  : 0 0 0 *! Number of times to unfold Brillouin zone i 
bsmethod                  : TB *! Method to use: 'KP' or 'TB' (String)          
dotddft                   : F *! Allow Time-Dependent DFT calculation (Boolean) 
tddftmaximumenergy        : 1.00000000000000      hartree *! Desired maximum of 
tddftresolution           : 1.000000000000000E-003 hartree *! Desired resolutio 
tddftpropagationmethod    : CRANKNICHOLSON *! Method used to integrate von Neum 
tddftsparsitylevel        : 0 *! Matrix sparsity when computing propagators e.g 
tddfttammdancoff          : F *! Invoke Tamm-Dancoff decoupling approximation ( 
tddftdipolekickstrength   : 0.0 0.0 0.0 *! Maximum allowed phase shift in TDDFT 
tddftxcfunctional         : LDA *! Exchange-correlation functional for TDDFT (S 
tddfthamiltonianmixing    : 0 *! Order of polynomial extrapolation to H(t + hal 
tddftdamping              : 0.000000000000000E+000 hartree *! Energy smearing w 
tddftenforcedidempotency  : F *! Project out at each timestep that part of chan 
tddftmaxithotelling       : 50 *! Number of Hotelling iteration per propagation 
tddftmaxresidhotelling    : 1.000000000000000E-018 *! Max allowed value in Hote 
tddftinvoverlapexact      : T *! Renew inverse overlap with O N^3 algorithm bef 
isimplicitsolvent         : F *! Use implicit solvent? (Boolean)                
issmearedionrep           : F *! Implicit solvent: use smeared ions for electro 
isincludecavitation       : F *! Implicit solvent: include cavitation energy (B 
isdensitythreshold        : 7.800000000000000E-004 *! Implicit solvent: rho_0 p 
issolvationbeta           : 1.30000000000000 *! Implicit solvent: beta paramete 
isbulkpermittivity        : 1.00000000000000 *! Implicit solvent: eps_inf param 
ismultigriddefecterrortol : 1.000000000000000E-002 *! Implicit solvent: stop cr 
ismultigriderrortol       : 1.000000000000000E-005 *! Implicit solvent: stop cr 
issmearedionwidth         : 0.800000000000000 *! Implicit solvent: Width of Gau 
issurfacethickness        : 2.000000000000000E-004 *! Implicit solvent: thickne 
issolventsurfacetension   : 4.762400000000000E-005 ha/bohr**2 *! Implicit solve 
ismultigridmaxiters       : 100 *! Implicit solvent: max number of iterations i 
ismultigridnlevels        : 4 *! Implicit solvent: number of levels in multigri 
isdiscretizationorder     : 8 *! Implicit solvent: discretization order (2nd, 4 
isbccoarseness            : 5 *! Open BCs: controls boundary condition coarse-g 
isbcsurfacecoarseness     : 1 *! Open BCs: controls boundary condition coarse-g 
isbcthreshold             : 1.000000000000000E-009 *! Open BCs: controls bounda 
ischecksolvenergygrad     : F *! Implicit solvent: sanity check the energy grad 
issolvationmethod         : DIRECT *! Implicit solvent: direct or corrective me 
isdielectricmodel         : FIX_INITIAL *! Implicit solvent: how the cavity is  
isdielectricfunction      : FGF *! Implicit solvent: how the cavity is determin 
issolvationoutputdetail   : NONE *! Implicit solvent: controls extra output (St 
openbcionion              : F *! Force open BCs in ion-ion energy (Boolean)     
openbchartree             : F *! Force open BCs in Hartree potential (Boolean)  
openbcpspot               : F *! Force open BCs in local pseudopotential (Boole 
openbcpspotfinetunenptsx  : 100000 *! Open BCs in local pseudo, npts_x paramete 
openbcpspotfinetunealpha  : 0.300000000000000 *! Open BCs in local pseudo, alph 
openbcpspotfinetunef      : -1 *! Open BCs in local pseudo, fineness parameter  
%block positionsabs       : *! Cartesian positions for each atom (Block)        
O	14.887507	13.896975	12.647313                                                 
C	17.731659	13.667449	12.643306                                                 
H	18.655157	11.72117	12.637547                                                  
H	18.955467	15.440371	12.646039                                                 
O	 9.766101	11.820471	12.648599                                                 
H	 7.687651	12.10307	12.651801                                                  
H	10.725313	13.685785	12.651874                                                 
%endblock positionsabs    : *! Cartesian positions for each atom (Block)        
%block latticecart        : *! The simulation cell lattice vectors (Block)      
30.00     0.00     0.00                                                         
0.00    25.00     0.00                                                          
0.00     0.00    25.00                                                          
%endblock latticecart     : *! The simulation cell lattice vectors (Block)      
%block species            : *! Species information (symbol, atomic number, numb 
O    O    8    4    7.3                                                         
C    C    6    4    7.3                                                         
H    H    1    1    7.0                                                         
%endblock species         : *! Species information (symbol, atomic number, numb 
%block speciespot         : *! Pseudopotential name for each species (Block)    
O    "../../pseudo/oxygen.recpot"                                               
C    "../../pseudo/carbon.recpot"                                               
H    "../../pseudo/hydrogen_coul.recpot"                                        
%endblock speciespot      : *! Pseudopotential name for each species (Block)    
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>
File: ../../pseudo/oxygen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 0; rc = 1.31 bohr
File: ../../pseudo/carbon.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  6;  ionic charge:  4.000000
    Shell 1: l = 0; rc = 1.48 bohr
File: ../../pseudo/hydrogen_coul.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  O          2         8         2
  C          1         4         1
  H          4         4         0
.......   ......    ......    ......
Totals:      7        16         3
-------------------------------------------------------------------------------
 
Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      5;  min      1;  average      4
... Projector load balancing: max      1;  min      0;  average      1
... done

Calculating Ewald energy ...
              Ewald: real-space energy =      21.001851
        Ewald: reciprocal-space energy =       2.530705
         Ewald: (sum_charge)**2 Energy =       3.935473
         Ewald: (sum_charge**2) Energy =       4.789650
                          Ewald Energy =      14.807433
... FFT-box specified

Basis initialisation ...
... Atom positions lie inside simulation cell
... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... NGWF basis size (local,global):       3644     12376
... Tight-boxes gathered
... done

============================== PSINC grid sizes ================================
                      Simulation cell:   39 x  33 x  33
                              FFT-box:   39 x  33 x  33
                                  PPD:    3 x  11 x  11
Grid space d1=  0.769230769231a0 (KE cutoff=  12.83780Eh = 349.33439eV)
Grid space d2=  0.757575757576a0 (KE cutoff=  13.23585Eh = 360.16583eV)
Grid space d3=  0.757575757576a0 (KE cutoff=  13.23585Eh = 360.16583eV)
================================================================================

********************** Fourier parallelisation information *********************
       Coarse grid (whole simulation cell) dimensions:     39    33    33

                 Real-space grid ('12' slabs):
                   Node    0:    8 (from    1 to    8)
                   Node    1:    8 (from    9 to   16)
                   Node    2:    9 (from   17 to   25)
                   Node    3:    8 (from   26 to   33)

                 Reciprocal-space grid ('23' slabs):
                   Node    0:    5 (from    1 to    5)
                   Node    1:    5 (from    6 to   10)
                   Node    2:    5 (from   11 to   15)
                   Node    3:    5 (from   16 to   20)
********************************************************************************

********************** Fourier parallelisation information *********************
       Double grid (whole simulation cell) dimensions:     78    66    66

                 Real-space grid ('12' slabs):
                   Node    0:   16 (from    1 to   16)
                   Node    1:   17 (from   17 to   33)
                   Node    2:   17 (from   34 to   50)
                   Node    3:   16 (from   51 to   66)

                 Reciprocal-space grid ('23' slabs):
                   Node    0:   10 (from    1 to   10)
                   Node    1:   10 (from   11 to   20)
                   Node    2:   10 (from   21 to   30)
                   Node    3:   10 (from   31 to   40)
********************************************************************************

=========================== Sparse matrix information ==========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling:  93.75%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  20.31%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done
NGWF initialisation ...... done

============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.35272134E+01     0.98173722E+00
               2       0.33127236E+01     0.96380802E+00
               3       0.31071706E+01     0.92892607E+00
               4       0.28978731E+01     0.86290401E+00
               5       0.26192271E+01     0.76864553E+00
               6       0.22203871E+01     0.65409521E+00
               7       0.17084342E+01     0.50604577E+00
               8       0.11517211E+01     0.35162897E+00
               9       0.59853197E+00     0.20331697E+00
              10       0.18247314E+00     0.73680041E-01
              11       0.21449523E-01     0.10013158E-01
              12       0.39979497E-03     0.19394156E-03
              13       0.15800746E-06     0.76258624E-07
              14       0.25092219E-13     0.12101431E-13
================================================================================
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -5.73879084851554    0.5741870
               2          -5.93559434318628    0.5653396
               3          -6.16906301544264    0.5562060
               4          -6.44864444308294    0.5458631
               5          -6.75219596270657    0.5357104
               6          -7.01748119664882    0.5237663
               7          -7.19207908368909    0.4961334
               8          -7.28103752623327    0.4663979
               9          -7.31092512000473    0.4827459
              10          -7.32146357096015    0.4979301
              11          -7.32322587091810    0.4999718
              12          -7.32326891881457    0.5000000
              13          -7.32326894411982    0.5663994
              14          -7.32326894411983    0.9975642
Final occupancy bounds: [    0.00000000000000:    1.00000000000000]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done

################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:      20.00000000
     Final electron number for spin 1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
      ideal mu1:      -0.339708202342
             Q0:     -36.023742613891
             G0:      -1.839589399413
   RMS gradient:       0.084769664925
    Initial Ne1:      20.00000000
      Final Ne1:      20.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001707 (step -0.4954 Ne1=     20.0000)
 RMS occupancy error at iteration   2:  0.000005 (step -0.5000 Ne1=     20.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     20.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -36.02374261389136 0.00000000000 0.08461198179 0.1000  0.000   20.00000000
      ideal mu1:      -0.375452267807
 2    -36.19681668832839 0.03176675933 0.07511002598 0.0000  0.000   20.00000000
Finished density kernel iterations (   2)

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.01569992392349              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       19.93012649089054 |
           | Pseudopotential (local)    :     -114.92329916955754 |
           | Pseudopotential (non-local):        5.78215277238771 |
           | Hartree                    :       47.44842425949803 |
           | Exchange-correlation       :       -7.50676293884265 |
           | Hartree-Fock exchange      :       -1.73489143247409 |
           | Ewald                      :       14.80743332976960 |
           | Total                      :      -36.19681668832840 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :     -114.92329916955427 |
           | Hartree                    :       47.44842425949668 |
           --------------------------------------------------------
           Integrated density           :       19.99999999999994
           Integrated density tr(KS)    :       20.00000000000000
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.12703563E+00     0.46141651E-01
               2       0.42037636E-02     0.20170558E-02
               3       0.77398023E-05     0.44318281E-05
               4       0.34233050E-10     0.21480706E-10
               5       0.19117950E-14     0.77715612E-15
================================================================================
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.16146374E+00     0.65512252E-01
               2       0.84656677E-02     0.49998179E-02
               3       0.38100068E-04     0.27661805E-04
               4       0.11233036E-08     0.85980323E-09
               5       0.18568518E-14     0.66613381E-15
================================================================================
RMS gradient                =       0.01569992392349
Trial step length           =               0.122474
Gradient along search dir.  =        -14.12620499806
Functional at step 0        =     -36.19681668832839
Functional at step 1        =     -37.55181966485983
Functional predicted        =     -38.19179873482321
Selected quadratic step     =               0.282451
Conjugate gradients coeff.  =               0.000000
--------------------------- NGWF line search finished --------------------------
                                               
WARNING: maximum number of NGWF CG iterations (   1) exceeded!

                    <<<<< CALCULATION SUMMARY >>>>>
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   1     0.01569992392349    -36.19681668832839  <-- CG                         
 
<QC>        [NGWF iterations]:        1
<QC>           [total_energy]:      -36.19681669
<QC>                     [F0]:      -36.19681669
<QC>                     [F1]:      -37.55181966
<QC>                     [F2]:        0.00000000
<QC>   [predicted_functional]:      -38.19179873
<QC>           [rms_gradient]:        0.015699923923
<QC>                 [G_init]:      -14.126204998062
<QC>        [quadratic_coeff]:        0.282451
<QC>            [cubic_coeff]:        0.000000
<QC>               [cg_coeff]:        0.000000
<QC>           [trial_length]:        0.122474

------------------------------ TIMING INFORMATION ------------------------------
TOTAL TIME:     165.018s on     4 node(s)
================== AVERAGE TIMINGS FROM ALL NODES (CUMULATIVE) =================
|| TAG                                   n calls    cpu time   %total  Gflops ||
|| total_time                          :       1     165.02s 100.000%  ------ ||
|| ewald_calculate_energy              :       1       0.00s   0.001%  ------ ||
|| sparse_init                         :       1       0.01s   0.008%  ------ ||
|| integrals_brappd_ketppd             :       3       0.01s   0.004%  ------ ||
|| integrals_kinetic                   :       3       0.06s   0.037%  ------ ||
|| basis_copy_function_to_box          :    1952       0.18s   0.106%  ------ ||
|| fourier_apply_box_pair              :    1863      28.19s  17.083%   7.970 ||
|| fourier_apply_box                   :    4152      28.90s  17.516%   9.863 ||
|| basis_extract_function_from_box     :     631       0.04s   0.026%  ------ ||
|| projectors_func_ovlp_box            :       3       0.01s   0.009%  ------ ||
|| pseudopotentials_nonlocal_mat       :       3       0.00s   0.001%  ------ ||
|| sparse_hotelling_invert             :       3       0.00s   0.003%  ------ ||
|| pseudo_make_structure_factor        :       1       0.00s   0.003%  ------ ||
|| pseudopotentials_local_on_grid      :       1       0.01s   0.007%  ------ ||
|| fourier_apply_cell_backward         :      23       0.10s   0.058%   3.832 ||
|| density_initial_guess_recip         :       1       0.01s   0.006%  ------ ||
|| hartree_on_grid                     :       5       0.04s   0.026%  ------ ||
|| fourier_apply_cell_forward          :      21       0.10s   0.063%   3.184 ||
|| integrals_locpot_dbl_grid           :       5       0.71s   0.429%  ------ ||
|| potential_apply_to_ngwf_batch       :       5       0.55s   0.333%  ------ ||
|| cell_grid_extract_box               :      37       0.02s   0.013%  ------ ||
|| palser_mano_kernel_optimise         :       1       0.01s   0.004%  ------ ||
|| ngwf_cg_optimise                    :       1     164.09s  99.436%  ------ ||
|| lnv_denskernel_optimise_cg          :       1      81.14s  49.171%  ------ ||
|| kernel_fix                          :       2       0.00s   0.002%  ------ ||
|| kernel_purify                       :       6       0.00s   0.001%  ------ ||
|| density_on_dbl_grid                 :       4       0.38s   0.229%  ------ ||
|| density_batch_row_sums              :       4       0.02s   0.014%  ------ ||
|| basis_add_function_to_box           :   29184       1.82s   1.100%  ------ ||
|| density_batch_interp_deposit        :       4       0.33s   0.198%  ------ ||
|| density_fftbox_interpolate_multiply :      20       0.31s   0.186%  ------ ||
|| density_fftbox_deposit_to_cell      :      20       0.02s   0.013%  ------ ||
|| cell_grid_deposit_box               :      20       0.02s   0.013%  ------ ||
|| xc_energy_potential                 :       4       0.25s   0.154%  ------ ||
|| hf_exchange_atomblock               :      49     143.43s  86.918%  ------ ||
|| hf_exchange_comms_wait              :     772      45.91s  27.822%  ------ ||
|| hf_exchange_ccsum_batch             :     256       6.36s   3.853%  ------ ||
|| hf_exchange_bb_fourier_interpolate  :     112       1.99s   1.204%  ------ ||
|| hf_exchange_fftpot_ngwf_ket         :     256     122.94s  74.501%  ------ ||
|| hf_exchange_atomblock_elements      :     112       1.93s   1.168%  ------ ||
|| lnv_gradient_norm                   :       2       0.00s   0.001%  ------ ||
|| ngwf_gradient_lnv                   :       1      40.98s  24.832%  ------ ||
|| ngwf_gradient_coeffs                :       1       0.00s   0.001%  ------ ||
|| ngwf_gradient_batch                 :       1       0.39s   0.239%  ------ ||
|| projectors_gradient_batch           :       1       0.02s   0.012%  ------ ||
|| hf_exchange_gradient                :      28       1.19s   0.722%  ------ ||
|| hamiltonian_energy_components       :       1       0.48s   0.291%  ------ ||
================================================================================

Job completed: 20-06-2011 12:19 (+0100)

