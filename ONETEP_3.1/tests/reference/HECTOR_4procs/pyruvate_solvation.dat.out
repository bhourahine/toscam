 +---------------------------------------------------------------+
 |                                                               |
 |        ####### #     # ####### ####### ####### ######         |
 |        #     # ##    # #          #    #       #     #        |
 |        #     # # #   # #          #    #       #     #        |
 |        #     # #  #  # #####      #    #####   ######         |
 |        #     # #   # # #          #    #       #              |
 |        #     # #    ## #          #    #       #              |
 |        ####### #     # #######    #    ####### #              |
 |                                                               |
 |        Linear-Scaling Ab Initio Total Energy Program          |
 |                                                               |
 |          Release for academic collaborators of ODG            |
 |                                              Version 2.9.5.3  |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |  Authors:                                                     |
 |  Peter D. Haynes, Nicholas D. M. Hine, Arash. A. Mostofi,     |
 |  Mike C. Payne and Chris-Kriton Skylaris                      |
 |                                                               |
 |  Contributors:                                                |
 |  P. W. Avraam, S. J. Clark, O. Dieguez, S. M. M. Dubois,      |
 |  J. Dziedzic, H. H. Helal, Q. O. Hill, D. D. O`Regan,         |
 |  C. J. Pickard, M. I. J. Probert, L. Ratcliff, M. Robinson    |
 |  and A. Ruiz Serrano                                          |
 |                                                               |
 |                                   Copyright (c) 2004-2011     |
 |                                                               |
 |  Please cite:                                                 |
 |  "Introducing ONETEP: Linear-scaling density functional       |
 |   simulations on parallel computers".                         |
 |   C.-K. Skylaris, P. D. Haynes, A. A. Mostofi, M. C. Payne.   |
 |   J. Chem. Phys. 122 084119 (2005).                           |
 |                                                               |
 |          in all publications arising from your use of ONETEP. |
 |                                                               |
 +---------------------------------------------------------------+
 |                                                               |
 |   ONETEP is based on developments described in the following  |
 |   publications:                                               |
 |                                                               |
 |  "Nonorthogonal generalized Wannier function pseudopotential  |
 |   plane-wave method".                                         |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, O. Dieguez,    |
 |   M. C. Payne.                                                |
 |   Phys. Rev. B 66 035119 (2002).                              |
 |                                                               |
 |  "Preconditioned iterative minimization for linear-scaling    |
 |   electronic structure calculations".                         |
 |   A. A. Mostofi, P. D. Haynes, C.-K. Skylaris, M. C. Payne.   |
 |   J. Chem. Phys. 119(17), pp.8842-8848 (2003).                |
 |                                                               |
 |  "Total-energy calculations on a real space grid with         |
 |   localized functions and a plane-wave basis".                |
 |   A. A. Mostofi, C.-K. Skylaris, P. D. Haynes, M. C. Payne.   |
 |   Comput. Phys. Commun. 147, pp.788-802 (2002).               |
 |                                                               |
 |  "Accurate kinetic energy evaluation in electronic structure  |
 |   calculations with localized functions on real space grids"  |
 |   C.-K. Skylaris, A. A. Mostofi, P. D. Haynes, C. J. Pickard, |
 |   M. C. Payne.                                                |
 |   Comput. Phys. Commun. 140, pp.315-322 (2001).               |
 |                                                               |
 +---------------------------------------------------------------+

Job started: 19-05-2011 13:45 (+0100)

Running on     4 processors.

Reading parameters from file "pyruvate_solvation.dat" ...... done
Reading geometry and species blocks from file "pyruvate_solvation.dat" ...
  <species_atomic_set> block not found: NGWF initialisation set to AUTO
    
  PSINC grid spacing along a1 set to   0.500000000000a0 from input file.
  PSINC grid spacing along a2 set to   0.500000000000a0 from input file.
  PSINC grid spacing along a3 set to   0.500000000000a0 from input file.
... done
-------------------------------------------------------------------------------
---------------------------- RUN-TIME PARAMETERS ------------------------------
-------------------------------------------------------------------------------
task                      : SINGLEPOINT *! Type of calculation (String)         
cutoffenergy              : 20.  hartree *! Plane wave kinetic energy cutoff (P 
kernelcutoff              : 1000. *! Density kernel radius in Bohr (Double Prec 
xcfunctional              : PBE *! Exchange-correlation functional (String)     
libxcxfuncid              : 0 *! Functional identifier for which exchange funct 
libxccfuncid              : 0 *! Functional identifier for which correlation fu 
charge                    : -1. *! The total charge of the system (Double Preci 
spin                      : 0 *! Total spin of system (Integer)                 
spinpolarized             : F *! Switch for spin polarization (Boolean)         
spinpolarised             : F *! Switch for spin polarisation (Boolean)         
constantefield            : 0.0 0.0 0.0 *! Cartesian coordinates of constant el 
fftboxpref                : 0 0 0 *! Preferred FFT box dimensions (String)      
ppdnpoints                : 0 0 0 *! PPD edge length in grid points for each la 
psincspacing              : 0.5 0.5 0.5 *! PSINC grid spacing in atomic units ( 
oldinput                  : F *! Read old-format input file (Boolean)           
develcode                 : *! For development code only (String)               
nnho                      : F *! Initialise NGWFs to nonorthogonal natural hybr 
ngwfhalo                  : -1. *! Halo extension to NGWF radii (Double Precisi 
nonscforces               : F *! Include non self-consistent forces due to NGWF 
maxitpalsermano           : 50 *! Maximum number of iterations for Palser-Manol 
maxitpen                  : 0 *! Max number of penalty functional iterations (I 
penparam                  : 4. *! Penalty functional parameter (Double Precisio 
minitlnv                  : 3 *! Min number of LNV iterations (Integer)         
maxitlnv                  : 3 *! Max number of LNV iterations (Integer)         
maxitlnvcoarse            : 0 *! Max number of low-accuracy LNV iterations (Int 
lnvthresholdorig          : 1.00000000000000006E-9 *! LNV convergence threshold 
lnvcgtype                 : LNV_FLETCHER *! Type of CG coefficient for LNV dens 
lnvcgmaxstep              : 3. *! Maximum length of trial step for kernel optim 
exactlnv                  : T *! Use original LNV algorithm (Boolean)           
oldlnv                    : F *! Use LNV algorithm backwards compatible pre Dec 
lnvchecktrialsteps        : F *! Check stability of kernel at each trial step d 
kerfix                    : 1 *! Density kernel fixing approach (Integer)       
maxitkernelfix            : 3 *! Maximum # iterations of Penalty Functional ide 
kerneldiis                : F *! Use kernel DIIS in the inner loop (Boolean)    
kerneldiistype            : P *! Density mixing method (String)                 
kerneldiismax             : 10 *! Max number of kernels saved during kernel DII 
kerneldiismaxit           : 25 *! Max number of kernel DIIS iterations (Integer 
kerneldiisthres           : 1.00000000000000006E-9 *! Density mixing convergenc 
kerneldiisliter           : 5 *! Number of linear mixing iterations (Integer)   
kerneldiiscin             : 0.90000000000000002 *! Coefficient for the input ke 
kerneldiiscriteria        : 1000 *! Density mixing convergence criteria (String 
maxitngwfcg               : 2 *! Max number of NGWF conjugate gradients (CG) it 
ngwfcgtype                : NGWF_FLETCHER *! Type of CG coefficient for NGWF op 
ngwfcgmaxstep             : -8. *! Maximum length of trial step for NGWF optimi 
eleccgmax                 : 0 *! Number of NGWF iterations to reset CG (Integer 
precondscheme             : TETER *! Recip-space preconditioning scheme (String 
kzero                     : 3. *! KE preconditioning parameter (Double Precisio 
rprecond                  : 2. *! Radial cut-off for real-space preconditioner  
precondrecip              : T *! Recip-space KE preconditioning (Boolean)       
precondreal               : F *! Real-space KE preconditioning (Boolean)        
smoothscheme              : NONE *! Smoothing scheme for the NGWF gradients at  
rsmooth                   : 1.5  bohr *! Radius of the unshaved NGWF gradients  
ksmooth                   : 5. *! Characteristic wavelength of the smoothing fu 
occmix                    : 1. *! Mix fraction of occupancy preconditioned NGWF 
kernelupdate              : F *! Update density kernel during NGWF line search  
kernelchristoffelupdate   : F *! Update density kernel during NGWF line search  
maxithotelling            : 50 *! Number of Hotelling iteration per NGWF change 
maxresidhotelling         : 9.9999999999999998E-13 *! Max allowed value in Hote 
maxitngwfdiis             : 0 *! Max number of NGWF DIIS steps (Integer)        
ngwfdiissize              : 4 *! Max size of the DIIS iterative subspace (Integ 
ngwfdiisreset             : 8 *! Max number of iteration for the resetting of D 
ngwfdiismaxstep           : 2. *! Max length of trial step for NGWF DIIS optimi 
ngwfthresholdorig         : 1.99999999999999991E-6 *! NGWF convergence threshol 
elecenergytol             : -1.00000000000000002E-3  hartree *! Tolerance on to 
elecforcetol              : -1.00000000000000002E-3  ha/bohr *! Tolerance on ma 
ngwfmaxgrad               : -2.00000000000000016E-5 *! Maximum permissible valu 
deltaeconv                : T *! Use consecutive energy gains as a criterion fo 
locpotintbatchsize        : 10 *! Size of NGWF in fftbox batch for locpot integ 
kineticintbatchsize       : 10 *! Size of NGWF in fftbox batch for kinetic inte 
densitybatchsize          : 10 *! Size of NGWF in fftbox batch for charge densi 
ngwfgradbatchsize         : 10 *! Size of NGWF in fftbox batch for NGWF gradien 
densethreshold            : 0.40000000000000002 *! Threshold for matrix segment 
commsgroupsize            : 4 *! Number of nodes in a group (determines comms e 
ovlpfornonlocal           : F *! Overlap sparsity for nonlocal (Boolean)        
usespacefillingcurve      : T *! Re-arrange atoms according to space-filling cu 
corehamdenskernguess      : T *! Initial guess for density kernel from core Ham 
checkatoms                : T *! Check atoms on top of each other (Boolean)     
locpotscheme              : FULL *! Scheme for evaluating local potential matri 
smoothprojectors          : -0.40000000000000002 *! Halfwidth of Gaussian filte 
smoothlocpspot            : -0.40000000000000002 *! Halfwidth of Gaussian filte 
oddpsincgrid              : F *! Force odd number of points in simcell psinc gr 
evenpsincgrid             : F *! Force even number of points in simcell psinc g 
realspaceprojectors       : F *! Whether to evaluate and store projectors in re 
outputdetail              : VERBOSE *! Level of output detail (String)          
pawoutputdetail           : DEFAULT *! Level of output detail for PAW: BRIEF, N 
timingslevel              : 0 *! Level of timings output: 0(none) 1(nodes summa 
writeparams               : T *! Output runtime parameters at startup (Boolean) 
writeforces               : F *! Write ionic forces (Boolean)                   
writepositions            : T *! Write ionic positions each geometry or MD step 
writexyz                  : F *! Output coordinates in .xyz file (Boolean)      
printqc                   : T *! Print Quality Control information (Boolean)    
cubeformat                : F *! Allow .cube format for plot outputs (Boolean)  
dxformat                  : F *! Allow .dx format for plot outputs (Boolean)    
dxformatcoarse            : F *! Output only points on the coarse grid (Boolean 
dxformatdigits            : 7 *! Number of significant digits in .dx output (In 
grdformat                 : T *! Allow .grd format for plot outputs (Boolean)   
writedensityplot          : T *! Write the charge density in plotting format (B 
writengwfplot             : F *! Write NGWFs in plotting format (Boolean)       
writengwfgradplot         : F *! Write NGWF Gradients in plotting format (Boole 
writengwfradial           : F *! Write NGWFs radial distributions (Boolean)     
writengwfgradradial       : F *! Write NGWFs gradients radial distributions (Bo 
writeradialstep           : 5.0000000000000001E-3  bohr *! Define the grid step 
writeradialsmear          : 1.00000000000000002E-2  bohr *! Define the gaussian 
readdenskern              : F *! Read density kernel restart information (Boole 
writedenskern             : F *! Write density kernel restart information (Bool 
readtightboxngwfs         : F *! Read in universal tightbox NGWFs restart infor 
writetightboxngwfs        : F *! Write in universal tightbox NGWFs restart info 
writeconvergeddkngwfs     : F *! Only write Density Kernel and NGWFs upon conve 
readswngwfs               : F *! Read NGWFs restart information in spherical wa 
writeswngwfs              : F *! Write NGWFs restart information in spherical w 
writemaxl                 : 3 *! Maximum angular momentum number when writing i 
readmaxl                  : 3 *! Maximum angular momentum number when reading i 
extransw                  : 0 *! Maximum number of zeros of the sph Bessel func 
paw                       : F *! Uses a PAW construction to find correct core d 
finegridscale             : 2. *! Ratio of size of fine grid to standard grid ( 
dblgridscale              : 2. *! Ratio of charge density / potential working g 
augfuncsrecip             : T *! Construct Augmentation functions in recip spac 
dispersion                : 0 *! Select dispersion correction (Integer)         
vdwdcoeff                 : -1. *! Replacement VDW damping coefficient (Double  
hubbardmaxiter            : 0 *! Maximum number of DFT+U projector optimisation 
hubbardenergytol          : 1.00000000000000002E-8  hartree *! Energy tolerance 
hubbardconvwin            : 2 *! Energy convergence window when using DFT+U pro 
hubbardprojmixing         : 0.E+0 *! Proportion of old Hubbard projector to mix 
hubbardfunctional         : 1 *! DFT+U energy functional to use (Integer)       
hubbardtensorcorr         : 1 *! DFT+U projector tensorial correction to use (I 
hubbardngwfspinthreshold  : 2.00000000000000016E-5 *! NGWF RMS  gradient thresh 
coulombcutoffradius       : 0.E+0 *! Radius of sphere or cylinder for cutoff co 
coulombcutofflength       : 0.E+0 *! Length of cylinder or width of slab for cu 
coulombcutofftype         : NONE *! Type of cutoff coulomb interaction: NONE, S 
coulombcutoffwriteint     : F *! Write real-space cutoff Coulomb interaction sc 
pbccorrectioncutoff       : 0.E+0 *! alpha*L cutoff parameter for Martyna-Tucke 
doproperties              : F *! Allow calculation of properties (Boolean)      
numeigenvalues            : 10 *! Number of energy and occupancy eigenvalues to 
homodensplot              : -1 *! Number of squared MOs to plot from HOMO and l 
lumodensplot              : -1 *! Number of squared MOs to plot from LUMO and h 
homoplot                  : 5 *! Number of MOs to plot from HOMO and lower (Int 
lumoplot                  : 5 *! Number of MOs to plot from LUMO and higher (In 
dossmear                  : 3.67489620595594195E-3  hartree *! Half width of sm 
ldossmear                 : 3.67489620595594195E-3  hartree *! Lorentzian broad 
popncalculate             : F *! Allow population analysis (Boolean)            
popnbondcutoff            : 5.669178939  bohr *! Bond length cutoff for populat 
ngwfanalysis              : F *! Perform NGWF analysis (Boolean)                
polarisationcalculate     : F *! Allow calculation of polarisation (Boolean)    
spreadcalculate           : F *! Calculate spread of NGWFs (Boolean)            
geommodulusest            : 1.70000000000000012E-2  ha/bohr**3 *! The estimated 
geomfrequencyest          : 7.59999999999999998E-3  hartree *! The estimated av 
geomenergytol             : 9.99999999999999955E-7  hartree *! Geometry optimiz 
geomforcetol              : 2.00000000000000004E-3  ha/bohr *! Geometry optimiz 
geomdisptol               : 5.0000000000000001E-3  bohr *! Geometry optimizatio 
geommaxiter               : 50 *! Maximum number of geometry optimization itera 
geomconvergencewin        : 2 *! Geometry optimization convergence tolerance wi 
geomcontinuation          : F *! Read information for continuation of a previou 
geombackupiter            : 1 *! Number of geometry optimisation iterations bet 
geomresetdkngwfsiter      : 6 *! Number of geom iterations between resets of ke 
geomreusedkngwfs          : T *! Re-use density kernel and NGWFs during geometr 
geomprintinvhessian       : F *! Write inverse Hessian to standard output (Bool 
geommethod                : CARTESIAN *! Method for geometry optimization (Stri 
tssearchmethod            : LSTQST *! Specifies method to be used for TS search 
tssearchlstqstprotocol    : LSTMAXIMUM *! Specifies LSTQST protocol (String)    
tssearchqstmaxiter        : 5 *! Specifies maximum number of QST steps (Integer 
tssearchcgmaxiter         : 20 *! Specifies maximum number of CG steps (Integer 
tssearchforcetol          : 5.0000000000000001E-3  ha/bohr *! Force tolerance f 
tssearchdisptol           : 1.00000000000000002E-2  bohr *! Displacement tolera 
mddeltat                  : 40.  aut *! Molecular dynamics time step (Physical) 
mdnumiter                 : 100 *! Maximum number of molecular dynamics iterati 
mdtemperature             : 9.49999999999999998E-4  hartree *! Temperature for  
mdalgorithm               : LEAPFROGVERLET *! Integration algorithm for molecul 
mdthermostat              : NONE *! Thermostat for molecular dynamics (String)  
mdcollisionfrequency      : 0.152  hartree *! Collision frequency for Andersen  
mixdenskern               : 0 *! Number of coefficients used to build new guess 
mixngwfs                  : 0 *! Number of coefficients used to build new guess 
condreaddenskern          : F *! Read in conduction density kernel (Boolean)    
condreadtightboxngwfs     : F *! Read in universal tightbox conduction NGWFs (B 
condfixedshift            : F *! Fixed projected conduction Hamiltonian shift ( 
condcalcmaxeigen          : T *! Calculate maximum conduction Hamiltonian eigen 
condnumstates             : 0 *! Number of conduction states to be optimised fo 
condkernelcutoff          : 1000. *! Conduction density kernel radius in Bohr ( 
condinitshift             : 0.E+0 *! Initial shifting factor for projected cond 
condshiftbuffer           : 0.10000000000000001 *! Additional buffer for updati 
condnumextrastates        : 0 *! Number of extra conduction states for initial  
condnumextraits           : 0 *! Number of NGWF iterations with extra conductio 
condplotjointorbitals     : T *! Plot orbitals in the joint basis following a c 
condplotvcorbitals        : T *! Plot orbitals in the val and cond NGWF basis s 
condcalcopticalspectra    : F *! Calculate matrix elements for optical absorpti 
condspeccalcmommatels     : T *! Calculate momentum matrix elements (default tr 
condspeccalcnonloccomm    : T *! Calculate nonlocal commutator for momentum mat 
condspeccontderiv         : T *! Calculate non-local commuator using continuous 
condspecnonloccommshift   : 1.00000000000000005E-4 *! Finite difference shift f 
bskpointpathspacing       : 0.18897269999999999  1/bohr *! K-point spacing alon 
bsnumeigenvalues          : -1 *! Num of energy and occ. eigenvalues to print b 
bsunfold                  : 0 0 0 *! Number of times to unfold Brillouin zone i 
bsmethod                  : TB *! Method to use: 'KP' or 'TB' (String)          
dotddft                   : F *! Allow Time-Dependent DFT calculation (Boolean) 
tddftmaximumenergy        : 1.  hartree *! Desired maximum of spectrum from TDD 
tddftresolution           : 1.00000000000000002E-3  hartree *! Desired resoluti 
tddftpropagationmethod    : CRANKNICHOLSON *! Method used to integrate von Neum 
tddftsparsitylevel        : 0 *! Matrix sparsity when computing propagators e.g 
tddfttammdancoff          : F *! Invoke Tamm-Dancoff decoupling approximation ( 
tddftdipolekickstrength   : 0.0 0.0 0.0 *! Maximum allowed phase shift in TDDFT 
tddftxcfunctional         : LDA *! Exchange-correlation functional for TDDFT (S 
tddfthamiltonianmixing    : 0 *! Order of polynomial extrapolation to H(t + hal 
tddftdamping              : 0.E+0  hartree *! Energy smearing when Fourier tran 
tddftenforcedidempotency  : F *! Project out at each timestep that part of chan 
tddftmaxithotelling       : 50 *! Number of Hotelling iteration per propagation 
tddftmaxresidhotelling    : 1.00000000000000007E-18 *! Max allowed value in Hot 
tddftinvoverlapexact      : T *! Renew inverse overlap with O N^3 algorithm bef 
isimplicitsolvent         : T *! Use implicit solvent? (Boolean)                
issmearedionrep           : T *! Implicit solvent: use smeared ions for electro 
isincludecavitation       : T *! Implicit solvent: include cavitation energy (B 
isdensitythreshold        : 3.49999999999999996E-4 *! Implicit solvent: rho_0 p 
issolvationbeta           : 1.3 *! Implicit solvent: beta parameter in Fatteber 
isbulkpermittivity        : 78.540000000000006 *! Implicit solvent: eps_inf par 
ismultigriddefecterrortol : 1.00000000000000002E-2 *! Implicit solvent: stop cr 
ismultigriderrortol       : 1.00000000000000008E-5 *! Implicit solvent: stop cr 
issmearedionwidth         : 0.80000000000000004 *! Implicit solvent: Width of G 
issurfacethickness        : 2.0000000000000001E-4 *! Implicit solvent: thicknes 
issolventsurfacetension   : 1.33859E-5  ha/bohr**2 *! Implicit solvent: surface 
ismultigridmaxiters       : 100 *! Implicit solvent: max number of iterations i 
ismultigridnlevels        : 4 *! Implicit solvent: number of levels in multigri 
isdiscretizationorder     : 10 *! Implicit solvent: discretization order (2nd,  
isbccoarseness            : 3 *! Implicit solvent: controls boundary condition  
isbcsurfacecoarseness     : 1 *! Implicit solvent: controls boundary condition  
ischecksolvenergygrad     : F *! Implicit solvent: sanity check the energy grad 
issolvationmethod         : DIRECT *! Implicit solvent: direct or corrective me 
isdielectricmodel         : FIX_INITIAL *! Implicit solvent: how the cavity is  
isdielectricfunction      : FGF *! Implicit solvent: how the cavity is determin 
issolvationoutputtype     : BOTH *! Implicit solvent: controls output (String)  
openbcionion              : F *! Force open BCs in ion-ion energy (Boolean)     
openbchartree             : F *! Force open BCs in Hartree potential (Boolean)  
openbcpspot               : F *! Force open BCs in local pseudopotential (Boole 
openbcpspotfinetunenptsx  : 100000 *! Open BCs in local pseudo, npts_x paramete 
openbcpspotfinetunealpha  : 0.29999999999999999 *! Open BCs in local pseudo, al 
openbcpspotfinetunef      : -1 *! Open BCs in local pseudo, fineness parameter  
%block positionsabs       : *! Cartesian positions for each atom (Block)        
C      23.03212536    21.66547677    20.00001701                                
C      21.21530414    19.39991534    19.99999055                                
C      18.30446146    20.20728603    20.00000000                                
O      18.03152442    22.57149309    19.99997732                                
O      16.77526612    18.41220612    20.00002457                                
O      21.99513395    17.22431247    19.99998110                                
H      24.99873199    20.99609204    19.99994520                                
H      22.63731984    22.85181140    21.65462596                                
H      22.63721023    22.85193423    18.34552711                                
%endblock positionsabs    : *! Cartesian positions for each atom (Block)        
%block latticecart        : *! The simulation cell lattice vectors (Block)      
40.5000000   0.0000000   0.0000000                                              
0.0000000  40.5000000   0.0000000                                               
0.0000000   0.0000000  40.5000000                                               
%endblock latticecart     : *! The simulation cell lattice vectors (Block)      
%block species            : *! Species information (symbol, atomic number, numb 
H   H   1 1 7.0                                                                 
C   C   6 4 7.0                                                                 
O   O   8 4 7.0                                                                 
%endblock species         : *! Species information (symbol, atomic number, numb 
%block speciespot         : *! Pseudopotential name for each species (Block)    
H   "../../pseudo/hydrogen.recpot"                                              
C   "../../pseudo/carbon.recpot"                                                
O   "../../pseudo/oxygen.recpot"                                                
%endblock speciespot      : *! Pseudopotential name for each species (Block)    
-------------------------------------------------------------------------------
-------------------------------------------------------------------------------

<<<<<<<<<<<<<<<<<<<<<<<<< Pseudopotential information >>>>>>>>>>>>>>>>>>>>>>>>>
File: ../../pseudo/carbon.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  6;  ionic charge:  4.000000
    Shell 1: l = 0; rc = 1.48 bohr
File: ../../pseudo/oxygen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  8;  ionic charge:  6.000000
    Shell 1: l = 0; rc = 1.31 bohr
File: ../../pseudo/hydrogen.recpot [ 2001 points up to Gmax=  52.9 (1/bohr)]
  Atomic number:  1;  ionic charge:  1.000000
    Local potential
<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<< >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

------------------------- Atom counting information ---------------------------
Symbol    Natoms    Nngwfs    Nprojs
  C          3        12         3
  O          3        12         3
  H          3         3         0
.......   ......    ......    ......
Totals:      9        27         6
-------------------------------------------------------------------------------
 
Determining parallel strategy ...
... using space-filling curve
... NGWF load balancing: max      8;  min      5;  average      7
... Projector load balancing: max      2;  min      1;  average      2
... done

Calculating direct Ion-Ion energy ...
Ion-Ion Energy        :       114.71600628419579
... FFT-box specified

Basis initialisation ...
... Atom positions lie inside simulation cell
... NGWF spheres initialised
... Projector spheres initialised
... NGWF tight boxes initialised
... NGWF basis size (local,global):       5624     20896
... Tight-boxes gathered
... done

============================== PSINC grid sizes ================================
                      Simulation cell:   81 x  81 x  81
                              FFT-box:   81 x  81 x  81
                                  PPD:    9 x   9 x   9
Grid space d1=  0.500000000000a0 (KE cutoff=  30.38533Eh = 826.83512eV)
Grid space d2=  0.500000000000a0 (KE cutoff=  30.38533Eh = 826.83512eV)
Grid space d3=  0.500000000000a0 (KE cutoff=  30.38533Eh = 826.83512eV)
================================================================================

********************** Fourier parallelisation information *********************
       Coarse grid (whole simulation cell) dimensions:     81    81    81

                 Real-space grid ('12' slabs):
                   Node    0:   20 (from    1 to   20)
                   Node    1:   20 (from   21 to   40)
                   Node    2:   21 (from   41 to   61)
                   Node    3:   20 (from   62 to   81)

                 Reciprocal-space grid ('23' slabs):
                   Node    0:   10 (from    1 to   10)
                   Node    1:   10 (from   11 to   20)
                   Node    2:   11 (from   21 to   31)
                   Node    3:   10 (from   32 to   41)
********************************************************************************

********************** Fourier parallelisation information *********************
       Double grid (whole simulation cell) dimensions:    162   162   162

                 Real-space grid ('12' slabs):
                   Node    0:   42 (from    1 to   42)
                   Node    1:   40 (from   43 to   82)
                   Node    2:   40 (from   83 to  122)
                   Node    3:   40 (from  123 to  162)

                 Reciprocal-space grid ('23' slabs):
                   Node    0:   20 (from    1 to   20)
                   Node    1:   21 (from   21 to   41)
                   Node    2:   21 (from   42 to   62)
                   Node    3:   20 (from   63 to   82)
********************************************************************************

=========================== Sparse matrix information ==========================
                        Overlap matrix filling: 100.00%
                        Density kernel filling: 100.00%
              NGWF-Proj overlap matrix filling:  99.38%
                    Hamiltonian matrix filling: 100.00%
                  NGWF diagonal matrix filling:  13.58%
                             KS matrix filling: 100.00% 
                           KSKS matrix filling: 100.00% 
================================================================================

Sparse matrix initialisation ... done
NGWF initialisation ...... done

ONETEP fine grid is 162 x 162 x 162 gridpoints, 40.5000 x 40.5000 x 40.5000 bohr.
FD multigrid is     161 x 161 x 161 gridpoints, 40.2500 x 40.2500 x 40.2500 bohr.

============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.48977266E+01     0.99203773E+00
               2       0.46955662E+01     0.98452494E+00
               3       0.44440142E+01     0.97061882E+00
               4       0.41917218E+01     0.94808456E+00
               5       0.39646534E+01     0.90965997E+00
               6       0.37252305E+01     0.84235942E+00
               7       0.33921366E+01     0.73365012E+00
               8       0.29230067E+01     0.59324909E+00
               9       0.23773962E+01     0.45417186E+00
              10       0.18522627E+01     0.36891759E+00
              11       0.13796091E+01     0.30407443E+00
              12       0.96236612E+00     0.22541385E+00
              13       0.57710068E+00     0.13033871E+00
              14       0.26009733E+00     0.49359624E-01
              15       0.64276509E-01     0.10398198E-01
              16       0.41236948E-02     0.64305144E-03
              17       0.17004806E-04     0.26479109E-05
              18       0.28916321E-09     0.45026871E-10
              19       0.47223373E-14     0.13322676E-14
================================================================================

Smeared ion self correction:     -79.289778


Smeared ion non-self correction: -114.556400
Calculating local pseudopotential in real space ...
Discrepancy between calculated realspace psloc and -Z/x on [5a0,70.148a0]:
max |rel. diff| # avg |rel. diff| #  avg rel. diff #  f # pseudopotential file
 0.000273320816    0.000031241646   0.000000500616   15  '../../pseudo/carbon.recpot'
 0.000916717492    0.000108716727   0.000000277879   15  '../../pseudo/oxygen.recpot'
 0.000542761820    0.000065679916   0.000000083093   15  '../../pseudo/hydrogen.recpot'
... done

MG boundary conditions: total CG'ed q: 0.9999734 over 12083 coarse points
MG Solving with 2nd order solver... done
MG Starting defect correction with a discretization order of: 10
MG Iteration ***   |error|   ***  |defect|  *** |error eq'n residual|  <-- D I
MG         1    0.1601864E+00   0.113060E+01       0.519567558E-04     <-- D I
MG         2    0.4764367E-02   0.615817E-01       0.504706259E-05     <-- D I
MG         3    0.3051681E-03   0.113734E-01       0.821367532E-06     <-- D I
MG         4    0.4291053E-04   0.555178E-02       0.757785451E-06     <-- D I
MG         5    0.1567081E-04   0.327569E-02       0.527449032E-06     <-- D I
MG         6    0.7660349E-05   0.203426E-02       0.182217330E-06     <-- D I
MG Defect correct solution obtained.
MG  - final defect norm:   0.2034E-02
MG  - final error norm :   0.7660E-05
MG  - defect iterations:   6
MG Hartree energy from (\int phi*rho dr):                21.772510
MG Hartree energy from (\int eps (grad phi)^2 dr):       21.772165
MG Discrepancy due to finite box and discretization:     -0.000345 (  -0.00158%)
MG Correction to account for finite box:                  0.000267
MG Remaining discrepancy, due to discretization:         -0.000077 (  -0.00035%)
Up spin density kernel initialisation ... 
======= Optimisation of K by Palser-Manolopoulos canonical purification ======== 
         Iteration  |  Band structure energy |    c_n   
               1          -8.42909982086779    0.5779725
               2          -8.78674407355674    0.5702101
               3          -9.23963251006989    0.5593782
               4          -9.78768200353500    0.5457493
               5         -10.37366287430874    0.5346844
               6         -10.87649253657828    0.5335215
               7         -11.18709601598859    0.5416301
               8         -11.31751010835124    0.5412251
               9         -11.36126887170596    0.5185182
              10         -11.37447036445722    0.5021195
              11         -11.37639021252550    0.5000230
              12         -11.37643186237828    0.5000000
              13         -11.37643188275240    0.4617203
              14         -11.37643188275242   -1.1771905
Final occupancy bounds: [    0.00000000000000:    1.00000000000000]
Closest occupancy to 0.5:     1.00000000000000
================================================================================
... done

################################################################################
########################### NGWF CG iteration  001 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:      34.00000000
     Final electron number for spin 1:      34.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.000000 (step -0.5000 Ne1=     34.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     34.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
MG boundary conditions: total CG'ed q: 0.9999851 over 6611 coarse points
MG Solving with 2nd order solver... done
MG Starting defect correction with a discretization order of: 10
MG Iteration ***   |error|   ***  |defect|  *** |error eq'n residual|  <-- D I
MG         1    0.1276245E+00   0.119376E+01       0.883463684E-04     <-- D I
MG         2    0.5206546E-02   0.125841E+00       0.159774526E-04     <-- D I
MG         3    0.6209901E-03   0.479628E-01       0.315613212E-05     <-- D I
MG         4    0.1848815E-03   0.266992E-01       0.174751496E-05     <-- D I
MG         5    0.8139990E-04   0.165277E-01       0.144515231E-05     <-- D I
MG         6    0.4004679E-04   0.106037E-01       0.492427735E-06     <-- D I
MG         7    0.2083970E-04   0.691666E-02       0.338722392E-06     <-- D I
MG         8    0.1185873E-04   0.456682E-02       0.225530977E-06     <-- D I
MG         9    0.7055088E-05   0.305556E-02       0.149451605E-06     <-- D I
MG Defect correct solution obtained.
MG  - final defect norm:   0.3056E-02
MG  - final error norm :   0.7055E-05
MG  - defect iterations:   9
MG Hartree energy from (\int phi*rho dr):                10.462470
MG Hartree energy from (\int eps (grad phi)^2 dr):       10.462002
MG Discrepancy due to finite box and discretization:     -0.000468 (  -0.00447%)
MG Correction to account for finite box:                  0.000278
MG Remaining discrepancy, due to discretization:         -0.000190 (  -0.00182%)
      ideal mu1:      -0.497658996092
             Q0:     -60.860720805422
             G0:      -3.486228934509
   RMS gradient:       0.069153503478
    Initial Ne1:      34.00000000
      Final Ne1:      34.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.001887 (step -0.4954 Ne1=     34.0000)
 RMS occupancy error at iteration   2:  0.000004 (step -0.5000 Ne1=     34.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     34.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -60.86072080542235 0.00000000000 0.08620649169 0.1000  0.000   34.00000000
MG boundary conditions: total CG'ed q: 0.9999850 over 6624 coarse points
MG Solving with 2nd order solver... done
MG Starting defect correction with a discretization order of: 10
MG Iteration ***   |error|   ***  |defect|  *** |error eq'n residual|  <-- D I
MG         1    0.1282102E+00   0.118821E+01       0.923873935E-04     <-- D I
MG         2    0.5193933E-02   0.119171E+00       0.727213317E-05     <-- D I
MG         3    0.5831773E-03   0.442254E-01       0.524506656E-05     <-- D I
MG         4    0.1770310E-03   0.244879E-01       0.224584651E-05     <-- D I
MG         5    0.7511783E-04   0.151240E-01       0.866973648E-06     <-- D I
MG         6    0.3627256E-04   0.968030E-02       0.592053051E-06     <-- D I
MG         7    0.1949618E-04   0.630003E-02       0.389483032E-06     <-- D I
MG         8    0.1118232E-04   0.415184E-02       0.254677117E-06     <-- D I
MG         9    0.6702068E-05   0.277430E-02       0.166482266E-06     <-- D I
MG Defect correct solution obtained.
MG  - final defect norm:   0.2774E-02
MG  - final error norm :   0.6702E-05
MG  - defect iterations:   9
MG Hartree energy from (\int phi*rho dr):                10.376029
MG Hartree energy from (\int eps (grad phi)^2 dr):       10.375575
MG Discrepancy due to finite box and discretization:     -0.000453 (  -0.00437%)
MG Correction to account for finite box:                  0.000277
MG Remaining discrepancy, due to discretization:         -0.000176 (  -0.00170%)
      ideal mu1:      -0.511064983629
             Q0:     -61.169227295764
             G0:      -3.723814354599
   RMS gradient:       0.053753504232
    Initial Ne1:      34.00000000
      Final Ne1:      34.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.005769 (step -0.4865 Ne1=     34.0000)
 RMS occupancy error at iteration   2:  0.000036 (step -0.5000 Ne1=     34.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     34.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -61.16922729576399 0.03895512813 0.06894919178 0.1000  0.604   34.00000000
MG boundary conditions: total CG'ed q: 0.9999850 over 6655 coarse points
MG Solving with 2nd order solver... done
MG Starting defect correction with a discretization order of: 10
MG Iteration ***   |error|   ***  |defect|  *** |error eq'n residual|  <-- D I
MG         1    0.1290509E+00   0.118088E+01       0.977370938E-04     <-- D I
MG         2    0.5185292E-02   0.110301E+00       0.692283248E-05     <-- D I
MG         3    0.5474018E-03   0.390643E-01       0.457030690E-05     <-- D I
MG         4    0.1575735E-03   0.214061E-01       0.232206689E-05     <-- D I
MG         5    0.6722183E-04   0.131691E-01       0.821702625E-06     <-- D I
MG         6    0.3208793E-04   0.840280E-02       0.560536479E-06     <-- D I
MG         7    0.1721133E-04   0.545548E-02       0.368282202E-06     <-- D I
MG         8    0.9890009E-05   0.358919E-02       0.240618744E-06     <-- D I
MG Defect correct solution obtained.
MG  - final defect norm:   0.3589E-02
MG  - final error norm :   0.9890E-05
MG  - defect iterations:   8
MG Hartree energy from (\int phi*rho dr):                10.307899
MG Hartree energy from (\int eps (grad phi)^2 dr):       10.307464
MG Discrepancy due to finite box and discretization:     -0.000435 (  -0.00422%)
MG Correction to account for finite box:                  0.000276
MG Remaining discrepancy, due to discretization:         -0.000159 (  -0.00154%)
      ideal mu1:      -0.524432306844
 3    -61.45994288316203 0.04962243126 0.04514387279 0.0000  0.000   34.00000000
Finished density kernel iterations (   3)

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00543544066865              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================

------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.19345163E-01     0.62862821E-02
               2       0.10231421E-03     0.34859214E-04
               3       0.32487937E-08     0.11126821E-08
               4       0.49910969E-14     0.13322676E-14
================================================================================
MG boundary conditions: total CG'ed q: 0.9999838 over 6747 coarse points
MG Solving with 2nd order solver... done
MG Starting defect correction with a discretization order of: 10
MG Iteration ***   |error|   ***  |defect|  *** |error eq'n residual|  <-- D I
MG         1    0.1250554E+00   0.116797E+01       0.960335938E-04     <-- D I
MG         2    0.5150408E-02   0.113236E+00       0.733658639E-05     <-- D I
MG         3    0.5762826E-03   0.390257E-01       0.414648278E-05     <-- D I
MG         4    0.1638084E-03   0.210744E-01       0.208865291E-05     <-- D I
MG         5    0.6770355E-04   0.129101E-01       0.784992147E-06     <-- D I
MG         6    0.3195022E-04   0.822584E-02       0.547813633E-06     <-- D I
MG         7    0.1701455E-04   0.533820E-02       0.361795228E-06     <-- D I
MG         8    0.9742632E-05   0.351319E-02       0.237334277E-06     <-- D I
MG Defect correct solution obtained.
MG  - final defect norm:   0.3513E-02
MG  - final error norm :   0.9743E-05
MG  - defect iterations:   8
MG Hartree energy from (\int phi*rho dr):                 9.591518
MG Hartree energy from (\int eps (grad phi)^2 dr):        9.591077
MG Discrepancy due to finite box and discretization:     -0.000441 (  -0.00460%)
MG Correction to account for finite box:                  0.000275
MG Remaining discrepancy, due to discretization:         -0.000166 (  -0.00173%)
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.23348426E+00     0.71212259E-01
               2       0.15772351E-01     0.57179368E-02
               3       0.97941057E-04     0.41325297E-04
               4       0.50170119E-08     0.23380494E-08
               5       0.51509023E-14     0.17763568E-14
================================================================================
RMS gradient                =       0.00543544066865
Trial step length           =               0.122474
Gradient along search dir.  =         -9.16866015253
Functional at step 0        =     -61.45994288316203
Functional at step 1        =     -62.52452085995580
Functional predicted        =     -66.86262979873362
Selected quadratic step     =               1.178512
--------------------------- NGWF line search finished --------------------------
                                               

################################################################################
########################### NGWF CG iteration  002 #############################
################################################################################
****** Reciprocal space K.E. preconditioning with k_zero =  3.0000 a0^-1 *******
   Initial electron number for spin 1:      35.03670417
     Final electron number for spin 1:      34.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.021391 (step -0.4483 Ne1=     34.0000)
 RMS occupancy error at iteration   2:  0.000852 (step -0.5001 Ne1=     34.0000)
 RMS occupancy error at iteration   3:  0.000003 (step -0.5000 Ne1=     34.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     34.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

................................................................................
<<<<<<<<<<<<<< LNV (Original version) density kernel optimisation >>>>>>>>>>>>>>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
iter|       energy      |  rms DeltaK |  commutator |LScoef|CGcoef|      Ne    |
MG boundary conditions: total CG'ed q: 0.9999753 over 8203 coarse points
MG Solving with 2nd order solver... done
MG Starting defect correction with a discretization order of: 10
MG Iteration ***   |error|   ***  |defect|  *** |error eq'n residual|  <-- D I
MG         1    0.9221162E-01   0.126402E+01       0.455334448E-04     <-- D I
MG         2    0.6010837E-02   0.214836E+00       0.123561674E-04     <-- D I
MG         3    0.1314581E-02   0.657180E-01       0.510447738E-05     <-- D I
MG         4    0.4418089E-03   0.275054E-01       0.187624027E-05     <-- D I
MG         5    0.1767707E-03   0.141667E-01       0.758885991E-06     <-- D I
MG         6    0.7894121E-04   0.825833E-02       0.849277406E-06     <-- D I
MG         7    0.3867254E-04   0.520390E-02       0.483789136E-06     <-- D I
MG         8    0.2038144E-04   0.351960E-02       0.298083291E-06     <-- D I
MG         9    0.1133860E-04   0.259017E-02       0.186867936E-06     <-- D I
MG        10    0.6513506E-05   0.209542E-02       0.115295023E-06     <-- D I
MG Defect correct solution obtained.
MG  - final defect norm:   0.2095E-02
MG  - final error norm :   0.6514E-05
MG  - defect iterations:   10
MG Hartree energy from (\int phi*rho dr):                 4.585989
MG Hartree energy from (\int eps (grad phi)^2 dr):        4.585283
MG Discrepancy due to finite box and discretization:     -0.000706 (  -0.01540%)
MG Correction to account for finite box:                  0.000274
MG Remaining discrepancy, due to discretization:         -0.000432 (  -0.00942%)
      ideal mu1:      -0.360563390343
             Q0:     -66.269689150140
             G0:      -1.180297498289
   RMS gradient:       0.040237591673
MG boundary conditions: total CG'ed q: 0.9999755 over 8332 coarse points
MG Solving with 2nd order solver... done
MG Starting defect correction with a discretization order of: 10
MG Iteration ***   |error|   ***  |defect|  *** |error eq'n residual|  <-- D I
MG         1    0.9562446E-01   0.127231E+01       0.708754838E-04     <-- D I
MG         2    0.6056734E-02   0.207684E+00       0.116036469E-04     <-- D I
MG         3    0.1265895E-02   0.622507E-01       0.416648014E-05     <-- D I
MG         4    0.4180977E-03   0.256601E-01       0.148565474E-05     <-- D I
MG         5    0.1662717E-03   0.130684E-01       0.140580370E-05     <-- D I
MG         6    0.7454018E-04   0.755906E-02       0.752414113E-06     <-- D I
MG         7    0.3666145E-04   0.476469E-02       0.458014406E-06     <-- D I
MG         8    0.1946016E-04   0.324381E-02       0.286417195E-06     <-- D I
MG         9    0.1079901E-04   0.241673E-02       0.177879410E-06     <-- D I
MG        10    0.6188480E-05   0.198310E-02       0.114800829E-06     <-- D I
MG Defect correct solution obtained.
MG  - final defect norm:   0.1983E-02
MG  - final error norm :   0.6188E-05
MG  - defect iterations:   10
MG Hartree energy from (\int phi*rho dr):                 4.904573
MG Hartree energy from (\int eps (grad phi)^2 dr):        4.903889
MG Discrepancy due to finite box and discretization:     -0.000685 (  -0.01396%)
MG Correction to account for finite box:                  0.000271
MG Remaining discrepancy, due to discretization:         -0.000413 (  -0.00843%)
     Trial step:       0.500000000000
             Q1:     -66.481845860795
 Quadratic coef:       0.377992038490
 Linear coef   :      -0.590148749144
           Qmin:     -66.500034971383
Quadratic minimum step length (  0.390318240235) accepted
    Initial Ne1:      34.00000000
      Final Ne1:      34.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.010478 (step -0.4727 Ne1=     34.0000)
 RMS occupancy error at iteration   2:  0.000134 (step -0.4998 Ne1=     34.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     34.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 1    -66.26968915014024 0.00000000000 0.04727590264 0.3903  0.000   34.00000000
MG boundary conditions: total CG'ed q: 0.9999754 over 8298 coarse points
MG Solving with 2nd order solver... done
MG Starting defect correction with a discretization order of: 10
MG Iteration ***   |error|   ***  |defect|  *** |error eq'n residual|  <-- D I
MG         1    0.9480005E-01   0.126956E+01       0.666318564E-04     <-- D I
MG         2    0.6043363E-02   0.208990E+00       0.117955164E-04     <-- D I
MG         3    0.1274827E-02   0.629369E-01       0.434788870E-05     <-- D I
MG         4    0.4224681E-03   0.260453E-01       0.155455142E-05     <-- D I
MG         5    0.1682199E-03   0.133063E-01       0.146183801E-05     <-- D I
MG         6    0.7542257E-04   0.770942E-02       0.774794101E-06     <-- D I
MG         7    0.3702573E-04   0.485833E-02       0.469595704E-06     <-- D I
MG         8    0.1965733E-04   0.330013E-02       0.294284389E-06     <-- D I
MG         9    0.1093395E-04   0.244867E-02       0.184271588E-06     <-- D I
MG        10    0.6267780E-05   0.200000E-02       0.116520261E-06     <-- D I
MG Defect correct solution obtained.
MG  - final defect norm:   0.2000E-02
MG  - final error norm :   0.6268E-05
MG  - defect iterations:   10
MG Hartree energy from (\int phi*rho dr):                 4.817149
MG Hartree energy from (\int eps (grad phi)^2 dr):        4.816461
MG Discrepancy due to finite box and discretization:     -0.000688 (  -0.01429%)
MG Correction to account for finite box:                  0.000272
MG Remaining discrepancy, due to discretization:         -0.000416 (  -0.00864%)
      ideal mu1:      -0.414805239946
             Q0:     -66.513835693809
             G0:      -0.189693683457
   RMS gradient:       0.015682742147
MG boundary conditions: total CG'ed q: 0.9999755 over 8363 coarse points
MG Solving with 2nd order solver... done
MG Starting defect correction with a discretization order of: 10
MG Iteration ***   |error|   ***  |defect|  *** |error eq'n residual|  <-- D I
MG         1    0.9538000E-01   0.127349E+01       0.576027899E-04     <-- D I
MG         2    0.6048712E-02   0.210239E+00       0.113975777E-04     <-- D I
MG         3    0.1281097E-02   0.632793E-01       0.434963758E-05     <-- D I
MG         4    0.4252510E-03   0.261330E-01       0.162043934E-05     <-- D I
MG         5    0.1698338E-03   0.133321E-01       0.679959676E-06     <-- D I
MG         6    0.7596064E-04   0.774588E-02       0.784666687E-06     <-- D I
MG         7    0.3743181E-04   0.489775E-02       0.456133227E-06     <-- D I
MG         8    0.1980428E-04   0.334873E-02       0.282446811E-06     <-- D I
MG         9    0.1098069E-04   0.250823E-02       0.175691445E-06     <-- D I
MG        10    0.6287642E-05   0.206877E-02       0.112586967E-06     <-- D I
MG Defect correct solution obtained.
MG  - final defect norm:   0.2069E-02
MG  - final error norm :   0.6288E-05
MG  - defect iterations:   10
MG Hartree energy from (\int phi*rho dr):                 4.941939
MG Hartree energy from (\int eps (grad phi)^2 dr):        4.941248
MG Discrepancy due to finite box and discretization:     -0.000691 (  -0.01398%)
MG Correction to account for finite box:                  0.000271
MG Remaining discrepancy, due to discretization:         -0.000420 (  -0.00850%)
     Trial step:       0.441768174632
             Q1:     -66.564276129715
 Quadratic coef:       0.033360196374
 Linear coef   :      -0.083800632280
           Qmin:     -66.566462377205
Quadratic minimum step length (  0.554859628826) accepted
    Initial Ne1:      33.99999679
      Final Ne1:      34.00000000

=================== Penalty functional idempotency correction ==================
 RMS occupancy error at iteration   1:  0.007687 (step -0.4805 Ne1=     34.0000)
 RMS occupancy error at iteration   2:  0.000093 (step -0.5001 Ne1=     34.0000)
            Final RMS occupancy error   :  0.000000 (Ne1=     34.0000)
               Final occupancy bounds   : [  0.0000,  1.0000]
================================================================================

 2    -66.51383569380856 0.08691804933 0.01946544724 0.5549  0.152   34.00000000
MG boundary conditions: total CG'ed q: 0.9999756 over 8382 coarse points
MG Solving with 2nd order solver... done
MG Starting defect correction with a discretization order of: 10
MG Iteration ***   |error|   ***  |defect|  *** |error eq'n residual|  <-- D I
MG         1    0.9553257E-01   0.127488E+01       0.553953821E-04     <-- D I
MG         2    0.6052969E-02   0.210657E+00       0.112929025E-04     <-- D I
MG         3    0.1283320E-02   0.633974E-01       0.434826789E-05     <-- D I
MG         4    0.4261481E-03   0.261680E-01       0.163616517E-05     <-- D I
MG         5    0.1703134E-03   0.133449E-01       0.688779431E-06     <-- D I
MG         6    0.7622682E-04   0.775417E-02       0.790551505E-06     <-- D I
MG         7    0.3755609E-04   0.490713E-02       0.457308821E-06     <-- D I
MG         8    0.1986108E-04   0.336074E-02       0.283024057E-06     <-- D I
MG         9    0.1101608E-04   0.252327E-02       0.176651569E-06     <-- D I
MG        10    0.6308407E-05   0.208628E-02       0.112616889E-06     <-- D I
MG Defect correct solution obtained.
MG  - final defect norm:   0.2086E-02
MG  - final error norm :   0.6308E-05
MG  - defect iterations:   10
MG Hartree energy from (\int phi*rho dr):                 4.974446
MG Hartree energy from (\int eps (grad phi)^2 dr):        4.973754
MG Discrepancy due to finite box and discretization:     -0.000692 (  -0.01391%)
MG Correction to account for finite box:                  0.000271
MG Remaining discrepancy, due to discretization:         -0.000421 (  -0.00847%)
      ideal mu1:      -0.435068417748
 3    -66.57024201333276 0.03576408718 0.00981563202 0.0000  0.000   34.00000000
Finished density kernel iterations (   3)

           ........................................................
           | *** NGWF optimisation not converged ***              |
           | RMS NGWF gradient =    0.00214751512378              |
           | Criteria not satisfied:                              |
           | -> RMS NGWF gradient higher than set threshold.      |
           ========================================================
MG boundary conditions: total CG'ed q: 0.9999756 over 8382 coarse points
MG Solving with 2nd order solver... done
MG Starting defect correction with a discretization order of: 10
MG Iteration ***   |error|   ***  |defect|  *** |error eq'n residual|  <-- D I
MG         1    0.9553257E-01   0.127488E+01       0.553953821E-04     <-- D I
MG         2    0.6052969E-02   0.210657E+00       0.112929025E-04     <-- D I
MG         3    0.1283320E-02   0.633974E-01       0.434826789E-05     <-- D I
MG         4    0.4261481E-03   0.261680E-01       0.163616517E-05     <-- D I
MG         5    0.1703134E-03   0.133449E-01       0.688779431E-06     <-- D I
MG         6    0.7622682E-04   0.775417E-02       0.790551505E-06     <-- D I
MG         7    0.3755609E-04   0.490713E-02       0.457308821E-06     <-- D I
MG         8    0.1986108E-04   0.336074E-02       0.283024057E-06     <-- D I
MG         9    0.1101608E-04   0.252327E-02       0.176651569E-06     <-- D I
MG        10    0.6308407E-05   0.208628E-02       0.112616889E-06     <-- D I
MG Defect correct solution obtained.
MG  - final defect norm:   0.2086E-02
MG  - final error norm :   0.6308E-05
MG  - defect iterations:   10
MG Hartree energy from (\int phi*rho dr):                 4.974446
MG Hartree energy from (\int eps (grad phi)^2 dr):        4.973754
MG Discrepancy due to finite box and discretization:     -0.000692 (  -0.01391%)
MG Correction to account for finite box:                  0.000271
MG Remaining discrepancy, due to discretization:         -0.000421 (  -0.00847%)

================================================================================
           ---------------- ENERGY COMPONENTS (Eh) ----------------
           | Kinetic                    :       46.87669097437371 |
           | Pseudo. (local,OBC,corr'd):       -32.31497379991333 |
           | Pseudopotential (non-local):        9.99123029409129 |
           | Hartree (molecular)        :        4.97444636751886 |
           | Exchange-correlation       :      -16.97812171995538 |
           | Ion-ion (open BC)          :      114.71600628419579 |
           | Smeared ion non-self corr. :     -114.55640018325349 |
           | Smeared ion self corr.     :      -79.28977822978476 |
           | Solvent cavitation energy  :        0.01065799939455 |
           | Total                      :      -66.57024201333276 |
           --------------------------------------------------------
           ------ LOCAL ENERGY COMPONENTS FROM MATRIX TRACES ------
           | Pseudopotential (local)    :      -32.31497379991387 |
           | Hartree                    :       -8.65018527324936 |
           --------------------------------------------------------
           Integrated density           :       33.99999999998450
           Integrated density tr(KS)    :       33.99999999999999
================================================================================


------------------------------- NGWF line search -------------------------------
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.31093843E-01     0.89081316E-02
               2       0.29227890E-03     0.82898792E-04
               3       0.33498994E-07     0.87819162E-08
               4       0.44976681E-14     0.15543122E-14
================================================================================
MG boundary conditions: total CG'ed q: 0.9999775 over 9094 coarse points
MG Solving with 2nd order solver... done
MG Starting defect correction with a discretization order of: 10
MG Iteration ***   |error|   ***  |defect|  *** |error eq'n residual|  <-- D I
MG         1    0.9641534E-01   0.127887E+01       0.632236025E-04     <-- D I
MG         2    0.6092578E-02   0.214523E+00       0.118503004E-04     <-- D I
MG         3    0.1306175E-02   0.652296E-01       0.437780887E-05     <-- D I
MG         4    0.4386942E-03   0.269904E-01       0.165631707E-05     <-- D I
MG         5    0.1773227E-03   0.137982E-01       0.704602110E-06     <-- D I
MG         6    0.8026762E-04   0.813758E-02       0.814009406E-06     <-- D I
MG         7    0.4000925E-04   0.537033E-02       0.475379398E-06     <-- D I
MG         8    0.2135262E-04   0.396699E-02       0.294672813E-06     <-- D I
MG         9    0.1191204E-04   0.327957E-02       0.182490072E-06     <-- D I
MG        10    0.6848606E-05   0.295403E-02       0.116556052E-06     <-- D I
MG Defect correct solution obtained.
MG  - final defect norm:   0.2954E-02
MG  - final error norm :   0.6849E-05
MG  - defect iterations:   10
MG Hartree energy from (\int phi*rho dr):                 5.089022
MG Hartree energy from (\int eps (grad phi)^2 dr):        5.088324
MG Discrepancy due to finite box and discretization:     -0.000698 (  -0.01372%)
MG Correction to account for finite box:                  0.000271
MG Remaining discrepancy, due to discretization:         -0.000427 (  -0.00840%)
============ Calculation of NGWF S^-1 using Hotelling algorithm ================ 
         Iteration  |  Frobenius norm and Maximum abs value    (of I-S*S_n^-1)   
               1       0.42130698E-01     0.14206911E-01
               2       0.57239732E-03     0.19776682E-03
               3       0.11604570E-06     0.37784612E-07
               4       0.75764311E-14     0.20539126E-14
================================================================================
RMS gradient                =       0.00214751512378
Trial step length           =               0.379918
Gradient along search dir.  =         -1.43122798152
Functional at step 0        =     -66.57024201333276
Functional at step 1        =     -66.97038454892349
Functional predicted        =     -67.08495217483359
Selected quadratic step     =               0.719257
--------------------------- NGWF line search finished --------------------------
                                               
WARNING: maximum number of NGWF CG iterations (   2) exceeded!

                    <<<<< CALCULATION SUMMARY >>>>>
|ITER|    RMS GRADIENT   |     TOTAL ENERGY    |   step   |     Epredicted      
   1     0.00543544066865    -61.45994288316203   1.178512    -66.86262979873362
   2     0.00214751512378    -66.57024201333276  <-- CG                         
 
<QC>        [NGWF iterations]:        2
<QC>           [total_energy]:      -66.57024201
<QC>                     [F0]:      -66.57024201
<QC>                     [F1]:      -66.97038455
<QC>                     [F2]:        0.00000000
<QC>   [predicted_functional]:      -67.08495217
<QC>           [rms_gradient]:        0.002147515124
<QC>                 [G_init]:       -1.431227981516
<QC>        [quadratic_coeff]:        0.719257
<QC>            [cubic_coeff]:        0.000000
<QC>               [cg_coeff]:        0.000000
<QC>           [trial_length]:        0.379918

------------------------------ TIMING INFORMATION ------------------------------
TOTAL TIME:    1011.144s on     4 node(s)

Job completed: 19-05-2011 14:02 (+0100)

Application 616373 resources: utime ~3845s, stime ~107s
